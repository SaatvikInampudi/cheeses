<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Cheese Chronicles: Exploring the Intersection of Sensory Qualities and Consumer Perception - 3&nbsp; Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./d3graph.html" rel="next">
<link href="./data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="site_libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="site_libs/wordcloud2-0.0.1/hover.js"></script>
<script src="site_libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="site_libs/d3-4.5.0/d3.min.js"></script>
<script src="site_libs/sankey-1/sankey.js"></script>
<script src="site_libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./results.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Cheese Chronicles: Exploring the Intersection of Sensory Qualities and Consumer Perception</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SaatvikInampudi/cheeses" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d3graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#installing-packages" id="toc-installing-packages" class="nav-link active" data-scroll-target="#installing-packages"><span class="header-section-number">3.0.1</span> Installing packages</a></li>
  <li><a href="#loading-and-cleaning-the-data" id="toc-loading-and-cleaning-the-data" class="nav-link" data-scroll-target="#loading-and-cleaning-the-data"><span class="header-section-number">3.0.2</span> Loading and Cleaning the Data</a></li>
  <li><a href="#cleaning-and-transforming-the-data" id="toc-cleaning-and-transforming-the-data" class="nav-link" data-scroll-target="#cleaning-and-transforming-the-data"><span class="header-section-number">3.0.3</span> Cleaning and transforming the data</a></li>
  <li><a href="#handling-missing-values" id="toc-handling-missing-values" class="nav-link" data-scroll-target="#handling-missing-values"><span class="header-section-number">3.0.4</span> Handling Missing Values</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/SaatvikInampudi/cheeses/edit/main/results.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/SaatvikInampudi/cheeses/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="installing-packages" class="level3" data-number="3.0.1">
<h3 data-number="3.0.1" class="anchored" data-anchor-id="installing-packages"><span class="header-section-number">3.0.1</span> Installing packages</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install necessary packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>required_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"tidytuesdayR"</span>, <span class="st">"naniar"</span>, <span class="st">"here"</span>, <span class="st">"fs"</span>, <span class="st">"rvest"</span>, <span class="st">"polite"</span>, <span class="st">"glue"</span>, <span class="st">"kableExtra"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>installed_packages <span class="ot">&lt;-</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytuesdayR)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar) <span class="co"># For missing value analysis</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(polite)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># For enhanced table styling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loading-and-cleaning-the-data" class="level3" data-number="3.0.2">
<h3 data-number="3.0.2" class="anchored" data-anchor-id="loading-and-cleaning-the-data"><span class="header-section-number">3.0.2</span> Loading and Cleaning the Data</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tuesdata <span class="ot">&lt;-</span> tidytuesdayR<span class="sc">::</span><span class="fu">tt_load</span>(<span class="st">'2024-06-04'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the cheeses dataset</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>cheeses <span class="ot">&lt;-</span> tuesdata<span class="sc">$</span>cheeses</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the cheeses dataset to a CSV file</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(cheeses, <span class="st">"cheeses_dataset.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirm the file has been saved</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Dataset saved as 'cheeses_dataset.csv'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset saved as 'cheeses_dataset.csv'</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cheeses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
  cheese     url   milk  country region family type  fat_content calcium_content
  &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;          
1 Aarewasser http… cow   Switze… &lt;NA&gt;   &lt;NA&gt;   semi… &lt;NA&gt;        &lt;NA&gt;           
2 Abbaye de… http… sheep France  Pays … &lt;NA&gt;   semi… &lt;NA&gt;        &lt;NA&gt;           
3 Abbaye de… http… cow   France  &lt;NA&gt;   &lt;NA&gt;   semi… 40-46%      &lt;NA&gt;           
4 Abbaye de… http… cow   France  Burgu… &lt;NA&gt;   semi… &lt;NA&gt;        &lt;NA&gt;           
5 Abbaye de… http… cow   France  Savoie &lt;NA&gt;   soft… &lt;NA&gt;        &lt;NA&gt;           
6 Abbaye de… http… cow   France  provi… &lt;NA&gt;   semi… &lt;NA&gt;        &lt;NA&gt;           
# ℹ 10 more variables: texture &lt;chr&gt;, rind &lt;chr&gt;, color &lt;chr&gt;, flavor &lt;chr&gt;,
#   aroma &lt;chr&gt;, vegetarian &lt;lgl&gt;, vegan &lt;lgl&gt;, synonyms &lt;chr&gt;,
#   alt_spellings &lt;chr&gt;, producers &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="cleaning-and-transforming-the-data" class="level3" data-number="3.0.3">
<h3 data-number="3.0.3" class="anchored" data-anchor-id="cleaning-and-transforming-the-data"><span class="header-section-number">3.0.3</span> Cleaning and transforming the data</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleaning and transforming the data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cheeses <span class="ot">&lt;-</span> cheeses <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fat_content =</span> <span class="fu">str_extract</span>(fat_content, <span class="st">"</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.*</span><span class="sc">\\</span><span class="st">d*"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">calcium_content =</span> <span class="fu">str_extract</span>(calcium_content, <span class="st">"</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.*</span><span class="sc">\\</span><span class="st">d*"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegetarian =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      vegetarian <span class="sc">==</span> <span class="st">"yes"</span> <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      vegetarian <span class="sc">==</span> <span class="st">"no"</span> <span class="sc">~</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vegan =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      vegan <span class="sc">==</span> <span class="st">"yes"</span> <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      vegan <span class="sc">==</span> <span class="st">"no"</span> <span class="sc">~</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the transformation</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cheeses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,187
Columns: 19
$ cheese          &lt;chr&gt; "Aarewasser", "Abbaye de Belloc", "Abbaye de Belval", …
$ url             &lt;chr&gt; "https://www.cheese.com/aarewasser/", "https://www.che…
$ milk            &lt;chr&gt; "cow", "sheep", "cow", "cow", "cow", "cow", "cow", "co…
$ country         &lt;chr&gt; "Switzerland", "France", "France", "France", "France",…
$ region          &lt;chr&gt; NA, "Pays Basque", NA, "Burgundy", "Savoie", "province…
$ family          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, "Cheddar", NA, NA, NA, NA,…
$ type            &lt;chr&gt; "semi-soft", "semi-hard, artisan", "semi-hard", "semi-…
$ fat_content     &lt;dbl&gt; NA, NA, 40, NA, NA, NA, 50, NA, 45, NA, NA, NA, NA, 52…
$ calcium_content &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ texture         &lt;chr&gt; "buttery", "creamy, dense, firm", "elastic", "creamy, …
$ rind            &lt;chr&gt; "washed", "natural", "washed", "washed", "washed", "wa…
$ color           &lt;chr&gt; "yellow", "yellow", "ivory", "white", "white", "pale y…
$ flavor          &lt;chr&gt; "sweet", "burnt caramel", NA, "acidic, milky, smooth",…
$ aroma           &lt;chr&gt; "buttery", "lanoline", "aromatic", "barnyardy, earthy"…
$ vegetarian      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ vegan           &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ synonyms        &lt;chr&gt; NA, "Abbaye Notre-Dame de Belloc", NA, NA, NA, NA, NA,…
$ alt_spellings   &lt;chr&gt; NA, NA, NA, NA, "Tamié, Trappiste de Tamie, Abbey of T…
$ producers       &lt;chr&gt; "Jumi", NA, NA, NA, NA, "Abbaye Cistercienne NOTRE-DAM…</code></pre>
</div>
</div>
<p>The code is used to clean and adjust the cheeses dataset by converting the fat_content and calcium_content columns into numeric values, extracting only the relevant digits. It also changes the vegetarian and vegan columns from “yes”/“no” responses to Boolean values (TRUE/FALSE), handling any other responses as NA. After these changes, the glimpse() function is used to check the updated dataset.</p>
</section>
<section id="handling-missing-values" class="level3" data-number="3.0.4">
<h3 data-number="3.0.4" class="anchored" data-anchor-id="handling-missing-values"><span class="header-section-number">3.0.4</span> Handling Missing Values</h3>
<p>To address the missing data, we employed the following strategies:</p>
<ol type="1">
<li><p><strong>Removal of Incomplete Cases:</strong> Rows with missing <code>fat_content</code> were excluded to ensure data integrity.</p></li>
<li><p><strong>Imputation:</strong> Missing values in <code>calcium_content</code> were imputed using the median value, preserving the central tendency of the data.</p></li>
</ol>
<p>These steps help mitigate the impact of missing data on our analysis, ensuring more reliable results.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of missing values before cleaning</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>missing_summary_before <span class="ot">&lt;-</span> cheeses <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Missing_Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Missing_Count))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing rows with missing fat_content</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>cheeses_clean <span class="ot">&lt;-</span> cheeses <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(fat_content))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputing missing calcium_content with the median value</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>cheeses_clean <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">calcium_content =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(calcium_content),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">median</span>(calcium_content, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                                   calcium_content))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of missing values after cleaning</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>missing_summary_after <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Missing_Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Missing_Count))</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary tables before and after cleaning</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(missing_summary_before, <span class="at">caption =</span> <span class="st">"Missing Values Before Cleaning"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Missing Values"</span> <span class="ot">=</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Missing Values Before Cleaning</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Missing Values
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Missing_Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">vegetarian</td>
<td style="text-align: right;">1187</td>
</tr>
<tr class="even">
<td style="text-align: left;">vegan</td>
<td style="text-align: right;">1187</td>
</tr>
<tr class="odd">
<td style="text-align: left;">calcium_content</td>
<td style="text-align: right;">1162</td>
</tr>
<tr class="even">
<td style="text-align: left;">alt_spellings</td>
<td style="text-align: right;">1078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fat_content</td>
<td style="text-align: right;">939</td>
</tr>
<tr class="even">
<td style="text-align: left;">synonyms</td>
<td style="text-align: right;">893</td>
</tr>
<tr class="odd">
<td style="text-align: left;">family</td>
<td style="text-align: right;">698</td>
</tr>
<tr class="even">
<td style="text-align: left;">producers</td>
<td style="text-align: right;">400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">region</td>
<td style="text-align: right;">332</td>
</tr>
<tr class="even">
<td style="text-align: left;">aroma</td>
<td style="text-align: right;">258</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rind</td>
<td style="text-align: right;">242</td>
</tr>
<tr class="even">
<td style="text-align: left;">color</td>
<td style="text-align: right;">142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">flavor</td>
<td style="text-align: right;">98</td>
</tr>
<tr class="even">
<td style="text-align: left;">texture</td>
<td style="text-align: right;">58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">milk</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="even">
<td style="text-align: left;">type</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">country</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">cheese</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">url</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(missing_summary_after, <span class="at">caption =</span> <span class="st">"Missing Values After Cleaning"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Missing Values"</span> <span class="ot">=</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Missing Values After Cleaning</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Missing Values
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Missing_Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">vegetarian</td>
<td style="text-align: right;">248</td>
</tr>
<tr class="even">
<td style="text-align: left;">vegan</td>
<td style="text-align: right;">248</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alt_spellings</td>
<td style="text-align: right;">206</td>
</tr>
<tr class="even">
<td style="text-align: left;">synonyms</td>
<td style="text-align: right;">172</td>
</tr>
<tr class="odd">
<td style="text-align: left;">family</td>
<td style="text-align: right;">165</td>
</tr>
<tr class="even">
<td style="text-align: left;">producers</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aroma</td>
<td style="text-align: right;">61</td>
</tr>
<tr class="even">
<td style="text-align: left;">region</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rind</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">color</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">texture</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">flavor</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">milk</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">country</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">cheese</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">url</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">fat_content</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">calcium_content</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The code provided effectively handles missing values in the dataset by first summarizing the missing data before any cleaning is done. It identifies the columns with the most missing values, such as vegetarian and vegan, which initially had 1187 missing entries. Next, the code removes rows with missing fat_content values and imputes missing calcium_content values with the median value, ensuring the dataset remains complete without losing important data. After cleaning, the missing values for key variables are significantly reduced, demonstrating the success of the cleaning process. This approach makes the dataset more reliable for analysis, ensuring that missing data doesn’t skew the results or lead to biased conclusions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheeses_clean, <span class="fu">aes</span>(<span class="at">x =</span> milk, <span class="at">fill =</span> milk)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Milk Types"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Milk Type"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bar chart reveals that cow’s milk overwhelmingly dominates cheese production, with a significantly higher count compared to other milk types. Goat and sheep milk are moderately popular, often appearing in pure form or mixed combinations like “goat, sheep” or “cow, goat.” Exotic milk types such as camel, moose, and water buffalo are used rarely, likely indicating niche or regional specialties. The presence of NA values highlights missing or unspecified milk type data. Overall, the chart emphasizes the global reliance on cow’s milk for cheese-making while also showcasing the diversity and occasional use of alternative milk sources.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>region_counts <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(region, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(region_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 20 Regions Producing Cheese"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Region"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheeses_clean <span class="sc">%&gt;%</span> <span class="fu">count</span>(rind, <span class="at">sort =</span> <span class="cn">TRUE</span>), <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> rind)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Rind Types"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Rind Type"</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheeses_clean, <span class="fu">aes</span>(<span class="at">x =</span> color, <span class="at">fill =</span> color)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Cheese Colors"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Color"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud2)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>aroma_words <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(aroma)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, aroma) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud2</span>(aroma_words, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"random-dark"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="wordcloud2 html-widget html-fill-item" id="htmlwidget-dc844c23addc178bda36" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-dc844c23addc178bda36">{"x":{"word":["fresh","aromatic","rich","strong","nutty","fruity","mild","sweet","earthy","pleasant","pungent","milky","mushroom","smokey","spicy","buttery","goaty","grassy","herbal","floral","lactic","yeasty","clean","musty","stinky","fermented","garlicky","subtle","barnyardy","perfumed","ripe","woody"],"freq":[38,36,24,22,15,13,13,13,12,12,11,10,9,9,9,8,8,8,7,6,6,6,3,3,3,2,2,2,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":3.31578947368421,"backgroundColor":"white","gridSize":0,"minRotation":-0.7853981633974483,"maxRotation":0.7853981633974483,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>synonym_words <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(synonyms)) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, synonyms) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud2</span>(synonym_words, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"random-light"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="wordcloud2 html-widget html-fill-item" id="htmlwidget-bacd7610ea5cd23d0ba4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bacd7610ea5cd23d0ba4">{"x":{"word":["cheese","de","leidse","boeren","asiago","dop","bavaria","bergkäse","blu","du","fresco","kaas","pecorino","queijo","aged","anthotyro","blue","burgos","fromage","minas","mozzarella","rupp","vorarlberger","allium","alpine","amarelo","anari","baixa","baladi","beira","brocciu","bufala","caerphilly","creamy","cumin","da","duckett's","farmers","fat","feta","free","fresh","geitost","havarti","jibneh","leiden","leyden","mitica","months","oveja","pavé","piper","provolone","pâte","smoked","swiss","vodcheese","vorarlberg","woodside","3","5","6","9","aisy","allgauer","allgäuer","allégé","alpenrebell","american","amu","anthotiro","aoc","aop","argentine","ash","ashen","baguette","baladieh","baluchon","basil's","belle","bergkase","bergkräuterrebell","bergrebell","bra","braunkäse","breakfast","brebiou","brie","brise","brune","buffalo","butter","butterkäse","camelbert","campana","carré","cendre","chambertin","chevre","chhana","chhena","chunk","classic","colorouge","crumbles","cura","curado","d'affinois","d'aisy","danish","delmonaco","di","dry","duro","d’allevo","ekte","empereur","extra","flødeis","foglie","frescal","from","fromager","gibne","gorgonzola","gournay","gudbrandsdalsost","havarathi","höhlenrebell","in","jibnah","jura","kapiti","khadra","käse","l'ami","l'amou","la","lacy","langres","le","leaves","leidenkaas","lyonnaise","léger","légère","l’empereur","mangorebell","manoypi","matin","meesjuusto","meia","mesost","met","mezzano","mild","miticana","miticaña","mouco","mountain","moyaux","myseost","mysost","mysuostur","nantais","nicholson","noce","noir","padrão","paprikarebell","pepper","petite","pfarr","pfefferrebell","plessis","port","priest","queijos","queso","red","rich","rustico","rüblirebell","saaland","sheep","sleutels","spicy","spinning","tasty","taupinette","the","trojan","trouville","troyes","truffello","vinage","walnut"],"freq":[16,7,7,6,5,5,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-light","minSize":0,"weightFactor":7.874999999999999,"backgroundColor":"white","gridSize":0,"minRotation":-0.7853981633974483,"maxRotation":0.7853981633974483,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>top_producers <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(producers, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_producers, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(producers, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Cheese Producers"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Producers"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cheese_country_counts <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese_country_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 15 Countries Producing Cheese"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Cheeses"</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bar chart highlights France as the leading producer of cheese, significantly outpacing all other countries in the dataset. Renowned for its cheese-making tradition, France’s dominance reflects its global reputation for diverse and high-quality cheeses. Canada, the United States, and Italy follow as notable contributors, showcasing their strong cheese industries, which cater to both traditional and modern cheese varieties. Countries like Australia, Austria, and Germany also feature prominently, emphasizing their established roles in the global cheese market. Smaller producers such as Sweden, Ireland, Greece, and Denmark contribute niche and unique cheeses, enriching the global diversity of cheese production. However, the chart reveals inconsistencies in the dataset, with multiple entries for the United Kingdom (e.g., “England, United Kingdom” and “England, Great Britain, United Kingdom”), suggesting a need for data standardization. Overall, the chart underscores France’s unparalleled leadership while highlighting the global spread and diversity of cheese production.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>top_countries <span class="ot">&lt;-</span> cheese_country_counts<span class="sc">$</span>country</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheeses_clean <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">%in%</span> top_countries), </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> fat_content, <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fat Content Distribution Across Top Cheese-Producing Countries"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Fat Content (%)"</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The boxplot visualizes the distribution of fat content percentages across cheeses from the top cheese-producing countries. Notably, Australia exhibits a wide range of fat content, with higher variability compared to other countries. Austria and France have relatively consistent fat content distributions, showing tighter interquartile ranges. Countries like Greece, Ireland, and Italy have moderately narrow distributions, indicating that cheeses from these regions tend to cluster around specific fat content levels. Outliers are present across several countries, such as France and the United States, highlighting unique cheeses with exceptionally high or low fat content. Additionally, there are redundant entries for the United Kingdom (e.g., “England, United Kingdom” and “England, Great Britain, United Kingdom”), suggesting the need for data standardization. Overall, the chart highlights both diversity in fat content and regional preferences or production standards in cheese-making across these nations.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>family_counts <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(family, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(family))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(family_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(family, n), <span class="at">y =</span> n, <span class="at">fill =</span> family)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cheese Family Diversity"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Family"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Cheeses"</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bar chart titled “Cheese Family Diversity” highlights the number of cheeses belonging to various cheese families. The chart reveals that Brie and Blue cheeses are the most diverse and numerous, indicating their global popularity and versatility in cheese-making. Cheddar and Gouda follow closely, reflecting their widespread production and demand. Families such as Swiss Cheese, Pasta Filata, and Parmesan also exhibit notable diversity, showcasing their prominence in specific culinary traditions. On the other hand, families like Havarti, Cornish, and Caciotta have fewer entries, indicating more specialized or regional production. The chart effectively illustrates the diversity within cheese families, showcasing a mix of globally dominant types alongside niche or region-specific varieties. This highlights the cultural and geographic influences on cheese production and preferences.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheeses_clean, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> fat_content, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fat Content by Cheese Type"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cheese Type"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Fat Content (%)"</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The boxplot illustrates the distribution of fat content percentages across various cheese types. It shows significant variability in fat content within and across different cheese categories. Soft and semi-soft cheeses, including subcategories like “soft-ripened” and “artisan,” tend to have higher variability, indicating a wide range of production methods and consumer preferences. Hard cheeses, such as “hard, artisan” and “hard, processed,” show more consistent fat content with tighter interquartile ranges. Some outliers are evident across multiple categories, especially in soft cheeses, highlighting unique variations or specialty cheeses with exceptionally high or low fat content. The presence of categories like “NA” suggests missing or unclassified data, which could skew the analysis. Overall, the plot emphasizes the diversity in fat content within cheese types, reflecting the complexity of cheese production and regional or traditional practices. Standardizing classifications could further clarify these patterns and improve the analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud2)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>texture_words <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(texture)) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, texture) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud2</span>(texture_words, <span class="at">size =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="wordcloud2 html-widget html-fill-item" id="htmlwidget-2200d368004147e498f1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2200d368004147e498f1">{"x":{"word":["creamy","smooth","firm","crumbly","soft","open","supple","dense","buttery","springy","compact","flaky","grainy","ripened","spreadable","crystalline","elastic","runny","brittle","chalky","chewy","dry","semi","stringy","close","fluffy","sticky"],"freq":[129,75,60,44,36,26,26,17,13,12,9,9,9,9,9,6,6,6,4,4,4,4,2,2,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":0.9767441860465115,"backgroundColor":"white","gridSize":0,"minRotation":-0.7853981633974483,"maxRotation":0.7853981633974483,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemapify)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>cheese_diversity <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country, family, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese_diversity, <span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> family, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_treemap</span>() <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_treemap_text</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">place =</span> <span class="st">"center"</span>, <span class="at">grow =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cheese Production Diversity by Country"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Family"</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_treemap_text()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The treemap titled “Cheese Production Diversity by Country” provides an insightful visualization of cheese production across various countries, with the size of each tile representing the diversity or count of cheeses produced in each country. The color coding within the tiles corresponds to different cheese families, offering a dual-layered perspective on global cheese diversity.</p>
<p>Key Observations 1. France and Italy as Global Leaders: France and Italy dominate the chart with the largest tiles, highlighting their unparalleled contributions to the global cheese landscape. France, often regarded as the epicenter of cheese-making, produces an extensive array of cheeses spanning families such as Brie, Camembert, and Blue. Similarly, Italy, known for its iconic cheeses like Parmesan, Mozzarella, and Pecorino, showcases a vibrant mix of cheese families. The diversity within these tiles underscores the depth and breadth of cheese-making traditions in these countries, reflecting centuries of innovation and culinary heritage. 2. Significant Contributions from Other Nations: Countries like Austria, Canada, Germany, and the United States also feature prominently in the treemap. Austria’s tile size suggests a substantial variety of cheeses, which may stem from its Alpine cheese-making traditions. Canada, though less renowned than France or Italy, emerges as a major producer with multiple contributions across different cheese families. The United States and Germany also show strong representation, reflecting their industrial-scale production and growing artisanal cheese movements. These countries highlight the increasing global participation in cheese-making, beyond traditionally dominant regions. 3. Smaller but Diverse Representation: The treemap includes smaller tiles for countries like Sweden, Greece, Portugal, and Switzerland, which are known for their regional specialties. Greece, for example, is synonymous with Feta, while Switzerland’s reputation is built on iconic cheeses like Swiss Cheese and Gruyere. These smaller tiles suggest a more focused production on specific cheese families, often tied to local traditions and geography. Such countries play an important role in maintaining the authenticity and heritage of regional cheeses. 4. Global Spread of Cheese Production: The chart also highlights contributions from less traditional cheese-producing nations, such as India, Cyprus, and Brazil. While their tile sizes are relatively small, their presence reflects the global nature of cheese production, as countries outside Europe are increasingly adopting and adapting cheese-making techniques to cater to local tastes and export markets. 5. Cheese Family Diversity: The colors within each tile represent the diversity of cheese families produced by each country. Families such as Brie, Blue, and Cheddar are widely distributed, reflecting their global appeal and adaptability to various production methods. In contrast, families like Feta, Pecorino, and Mozzarella are more regionally concentrated, showcasing their cultural and geographical ties. The color diversity within larger tiles like France and Italy reinforces their position as leaders in producing a wide range of cheese families. 6. Repetition and Data Redundancy: Some countries, such as Canada, Australia, and the United Kingdom, appear multiple times in the treemap, suggesting possible inconsistencies or redundancy in the dataset. This could stem from variations in how producers or regions within these countries are categorized. For instance, separate tiles for “England, United Kingdom” and “Great Britain” indicate overlapping entries that may require consolidation for a more accurate representation.</p>
<p>Insights and Interpretation</p>
<p>The treemap highlights the dominance of traditional cheese-making countries like France and Italy while illustrating the growing global footprint of cheese production. The prominence of diverse cheese families within countries like France, Italy, and Austria reflects their long-standing traditions and expertise in cheese-making. Meanwhile, the presence of smaller tiles for countries like India, Brazil, and Cyprus indicates that cheese production is no longer confined to Europe, with new players entering the global market.</p>
<p>The visualization also reveals the global popularity of certain cheese families, such as Blue, Brie, and Cheddar, which appear across multiple countries, as well as the regional specificity of others like Feta and Pecorino. This underscores the balance between global demand for well-known cheeses and the preservation of traditional, region-specific varieties.</p>
<p>Conclusion</p>
<p>This treemap effectively captures the diversity of cheese production on a global scale, showcasing the leadership of traditional cheese-making countries alongside the emergence of new contributors. The wide variety of cheese families highlights the rich culinary heritage and evolving nature of the cheese industry. However, the repeated entries for some countries suggest a need for data cleaning and standardization to enhance the clarity and accuracy of the visualization. With these refinements, the treemap can serve as a powerful tool for understanding global cheese production patterns and their cultural significance.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(cheeses_clean, <span class="at">x =</span> <span class="sc">~</span>fat_content, <span class="at">type =</span> <span class="st">"histogram"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Interactive Histogram of Fat Content"</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Fat Content (%)"</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Count"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(cheeses_clean, <span class="at">x =</span> <span class="sc">~</span>type, <span class="at">y =</span> <span class="sc">~</span>fat_content, <span class="at">type =</span> <span class="st">"box"</span>, <span class="at">color =</span> <span class="sc">~</span>type) <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Fat Content by Cheese Type"</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Cheese Type"</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Fat Content (%)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Ignoring 1 observations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RColorBrewer::brewer.pal(N, "Set2"): n too large, allowed maximum for palette Set2 is 8
Returning the palette you asked for with that many colors
Warning in RColorBrewer::brewer.pal(N, "Set2"): n too large, allowed maximum for palette Set2 is 8
Returning the palette you asked for with that many colors</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9d6e4591aa777b52aee9" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9d6e4591aa777b52aee9">{"x":{"visdat":{"16c821b058157":["function () ","plotlyVisDat"]},"cur_data":"16c821b058157","attrs":{"16c821b058157":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Fat Content by Cheese Type","xaxis":{"domain":[0,1],"automargin":true,"title":"Cheese Type","type":"category","categoryorder":"array","categoryarray":["firm","firm, artisan","firm, artisan, blue-veined","firm, artisan, brined","fresh firm","fresh firm, artisan","fresh firm, soft-ripened","fresh soft","fresh soft, artisan","fresh soft, hard, artisan","fresh soft, soft-ripened","fresh soft, whey","hard","hard, artisan","hard, artisan, processed","hard, processed","hard, semi-hard","hard, whey","semi-firm, artisan","semi-hard","semi-hard, artisan","semi-hard, artisan, smear-ripened","semi-hard, blue-veined","semi-hard, brined","semi-hard, processed","semi-hard, soft-ripened","semi-soft","semi-soft, artisan","semi-soft, artisan, brined","semi-soft, artisan, soft-ripened","semi-soft, blue-veined","semi-soft, brined","semi-soft, firm","semi-soft, processed","semi-soft, smear-ripened","semi-soft, soft-ripened","semi-soft, whey","soft","soft, artisan","soft, artisan, blue-veined","soft, artisan, brined","soft, artisan, smear-ripened","soft, artisan, soft-ripened","soft, blue-veined","soft, brined","soft, processed","soft, semi-soft, artisan","soft, semi-soft, soft-ripened","soft, soft-ripened"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Fat Content (%)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(102,194,165,0.5)","x":["firm"],"y":[45],"type":"box","name":"firm","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(136,188,155,0.5)","x":["firm, artisan"],"y":[31],"type":"box","name":"firm, artisan","marker":{"color":"rgba(136,188,155,1)","line":{"color":"rgba(136,188,155,1)"}},"line":{"color":"rgba(136,188,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(163,182,145,0.5)","x":["firm, artisan, blue-veined"],"y":[34],"type":"box","name":"firm, artisan, blue-veined","marker":{"color":"rgba(163,182,145,1)","line":{"color":"rgba(163,182,145,1)"}},"line":{"color":"rgba(163,182,145,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(185,175,135,0.5)","x":["firm, artisan, brined"],"y":[0],"type":"box","name":"firm, artisan, brined","marker":{"color":"rgba(185,175,135,1)","line":{"color":"rgba(185,175,135,1)"}},"line":{"color":"rgba(185,175,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(204,167,126,0.5)","x":["fresh firm"],"y":[20.800000000000001],"type":"box","name":"fresh firm","marker":{"color":"rgba(204,167,126,1)","line":{"color":"rgba(204,167,126,1)"}},"line":{"color":"rgba(204,167,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(222,159,116,0.5)","x":["fresh firm, artisan","fresh firm, artisan"],"y":[45,45],"type":"box","name":"fresh firm, artisan","marker":{"color":"rgba(222,159,116,1)","line":{"color":"rgba(222,159,116,1)"}},"line":{"color":"rgba(222,159,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(239,150,106,0.5)","x":["fresh firm, soft-ripened"],"y":[7],"type":"box","name":"fresh firm, soft-ripened","marker":{"color":"rgba(239,150,106,1)","line":{"color":"rgba(239,150,106,1)"}},"line":{"color":"rgba(239,150,106,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(250,141,100,0.5)","x":["fresh soft","fresh soft","fresh soft","fresh soft","fresh soft","fresh soft"],"y":[25.219999999999999,45,46,24,12,40],"type":"box","name":"fresh soft","marker":{"color":"rgba(250,141,100,1)","line":{"color":"rgba(250,141,100,1)"}},"line":{"color":"rgba(250,141,100,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(238,145,116,0.5)","x":["fresh soft, artisan","fresh soft, artisan","fresh soft, artisan","fresh soft, artisan","fresh soft, artisan","fresh soft, artisan","fresh soft, artisan","fresh soft, artisan"],"y":[45,40,22,45,22,25.399999999999999,18.199999999999999,14],"type":"box","name":"fresh soft, artisan","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"line":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(225,148,131,0.5)","x":["fresh soft, hard, artisan"],"y":[8],"type":"box","name":"fresh soft, hard, artisan","marker":{"color":"rgba(225,148,131,1)","line":{"color":"rgba(225,148,131,1)"}},"line":{"color":"rgba(225,148,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(211,151,147,0.5)","x":["fresh soft, soft-ripened"],"y":[60],"type":"box","name":"fresh soft, soft-ripened","marker":{"color":"rgba(211,151,147,1)","line":{"color":"rgba(211,151,147,1)"}},"line":{"color":"rgba(211,151,147,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(196,153,162,0.5)","x":["fresh soft, whey"],"y":[40],"type":"box","name":"fresh soft, whey","marker":{"color":"rgba(196,153,162,1)","line":{"color":"rgba(196,153,162,1)"}},"line":{"color":"rgba(196,153,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(178,156,177,0.5)","x":["hard","hard","hard","hard","hard","hard","hard","hard","hard","hard","hard","hard","hard","hard","hard","hard","hard"],"y":[45,34,34,35,48,49,48,30,25,45,45,30.5,33,18.300000000000001,32.299999999999997,40,34.399999999999999],"type":"box","name":"hard","marker":{"color":"rgba(178,156,177,1)","line":{"color":"rgba(178,156,177,1)"}},"line":{"color":"rgba(178,156,177,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(158,158,192,0.5)","x":["hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan","hard, artisan"],"y":[45,52,34,34,34,34,34,54.229999999999997,45,32,62,30,30,50,40,51,48,45,40,48,45,40,45,51,36,48],"type":"box","name":"hard, artisan","marker":{"color":"rgba(158,158,192,1)","line":{"color":"rgba(158,158,192,1)"}},"line":{"color":"rgba(158,158,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(146,159,203,0.5)","x":["hard, artisan, processed"],"y":[7.7999999999999998],"type":"box","name":"hard, artisan, processed","marker":{"color":"rgba(146,159,203,1)","line":{"color":"rgba(146,159,203,1)"}},"line":{"color":"rgba(146,159,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(161,157,201,0.5)","x":["hard, processed"],"y":[26],"type":"box","name":"hard, processed","marker":{"color":"rgba(161,157,201,1)","line":{"color":"rgba(161,157,201,1)"}},"line":{"color":"rgba(161,157,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(175,154,200,0.5)","x":["hard, semi-hard"],"y":[26],"type":"box","name":"hard, semi-hard","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"line":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(188,151,199,0.5)","x":["hard, whey"],"y":[30],"type":"box","name":"hard, whey","marker":{"color":"rgba(188,151,199,1)","line":{"color":"rgba(188,151,199,1)"}},"line":{"color":"rgba(188,151,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(201,148,198,0.5)","x":["semi-firm, artisan","semi-firm, artisan"],"y":[45,55],"type":"box","name":"semi-firm, artisan","marker":{"color":"rgba(201,148,198,1)","line":{"color":"rgba(201,148,198,1)"}},"line":{"color":"rgba(201,148,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(213,144,197,0.5)","x":["semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard","semi-hard"],"y":[40,14,40,46,46,20,15,39.600000000000001,32.5,25,34.200000000000003,48,50,45,50,30,17],"type":"box","name":"semi-hard","marker":{"color":"rgba(213,144,197,1)","line":{"color":"rgba(213,144,197,1)"}},"line":{"color":"rgba(213,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(224,140,196,0.5)","x":["semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan","semi-hard, artisan"],"y":[48,50,33,45,30,29.800000000000001,50,50,35,50,50,50,45,18.399999999999999,50,50,40,45,40.5,45,8],"type":"box","name":"semi-hard, artisan","marker":{"color":"rgba(224,140,196,1)","line":{"color":"rgba(224,140,196,1)"}},"line":{"color":"rgba(224,140,196,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(228,144,189,0.5)","x":["semi-hard, artisan, smear-ripened","semi-hard, artisan, smear-ripened"],"y":[45,45],"type":"box","name":"semi-hard, artisan, smear-ripened","marker":{"color":"rgba(228,144,189,1)","line":{"color":"rgba(228,144,189,1)"}},"line":{"color":"rgba(228,144,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(222,157,174,0.5)","x":["semi-hard, blue-veined"],"y":[8],"type":"box","name":"semi-hard, blue-veined","marker":{"color":"rgba(222,157,174,1)","line":{"color":"rgba(222,157,174,1)"}},"line":{"color":"rgba(222,157,174,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(214,169,159,0.5)","x":["semi-hard, brined"],"y":[45],"type":"box","name":"semi-hard, brined","marker":{"color":"rgba(214,169,159,1)","line":{"color":"rgba(214,169,159,1)"}},"line":{"color":"rgba(214,169,159,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(205,180,144,0.5)","x":["semi-hard, processed"],"y":[50],"type":"box","name":"semi-hard, processed","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"line":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(196,191,128,0.5)","x":["semi-hard, soft-ripened"],"y":[55],"type":"box","name":"semi-hard, soft-ripened","marker":{"color":"rgba(196,191,128,1)","line":{"color":"rgba(196,191,128,1)"}},"line":{"color":"rgba(196,191,128,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(185,202,111,0.5)","x":["semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft","semi-soft"],"y":[12,33.5,48,28,25.5,50,45,50,8,50,14,50,40,72.700000000000003,45,45],"type":"box","name":"semi-soft","marker":{"color":"rgba(185,202,111,1)","line":{"color":"rgba(185,202,111,1)"}},"line":{"color":"rgba(185,202,111,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(172,212,93,0.5)","x":["semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan","semi-soft, artisan"],"y":[25,45,11,40,45,20,45,45,28,5,40,23,40,45,25],"type":"box","name":"semi-soft, artisan","marker":{"color":"rgba(172,212,93,1)","line":{"color":"rgba(172,212,93,1)"}},"line":{"color":"rgba(172,212,93,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(174,216,81,0.5)","x":["semi-soft, artisan, brined","semi-soft, artisan, brined"],"y":[50,45],"type":"box","name":"semi-soft, artisan, brined","marker":{"color":"rgba(174,216,81,1)","line":{"color":"rgba(174,216,81,1)"}},"line":{"color":"rgba(174,216,81,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(188,217,77,0.5)","x":["semi-soft, artisan, soft-ripened"],"y":[26],"type":"box","name":"semi-soft, artisan, soft-ripened","marker":{"color":"rgba(188,217,77,1)","line":{"color":"rgba(188,217,77,1)"}},"line":{"color":"rgba(188,217,77,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(202,217,72,0.5)","x":["semi-soft, blue-veined","semi-soft, blue-veined"],"y":[50,27],"type":"box","name":"semi-soft, blue-veined","marker":{"color":"rgba(202,217,72,1)","line":{"color":"rgba(202,217,72,1)"}},"line":{"color":"rgba(202,217,72,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(215,217,67,0.5)","x":["semi-soft, brined","semi-soft, brined"],"y":[25,45],"type":"box","name":"semi-soft, brined","marker":{"color":"rgba(215,217,67,1)","line":{"color":"rgba(215,217,67,1)"}},"line":{"color":"rgba(215,217,67,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(227,217,62,0.5)","x":["semi-soft, firm"],"y":[30],"type":"box","name":"semi-soft, firm","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"line":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(240,217,56,0.5)","x":["semi-soft, processed","semi-soft, processed","semi-soft, processed","semi-soft, processed"],"y":[30,43,31,45],"type":"box","name":"semi-soft, processed","marker":{"color":"rgba(240,217,56,1)","line":{"color":"rgba(240,217,56,1)"}},"line":{"color":"rgba(240,217,56,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,217,49,0.5)","x":["semi-soft, smear-ripened","semi-soft, smear-ripened"],"y":[50,42],"type":"box","name":"semi-soft, smear-ripened","marker":{"color":"rgba(252,217,49,1)","line":{"color":"rgba(252,217,49,1)"}},"line":{"color":"rgba(252,217,49,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(253,215,63,0.5)","x":["semi-soft, soft-ripened","semi-soft, soft-ripened","semi-soft, soft-ripened"],"y":[45,13,28],"type":"box","name":"semi-soft, soft-ripened","marker":{"color":"rgba(253,215,63,1)","line":{"color":"rgba(253,215,63,1)"}},"line":{"color":"rgba(253,215,63,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(250,212,80,0.5)","x":["semi-soft, whey","semi-soft, whey","semi-soft, whey"],"y":[20,27,36],"type":"box","name":"semi-soft, whey","marker":{"color":"rgba(250,212,80,1)","line":{"color":"rgba(250,212,80,1)"}},"line":{"color":"rgba(250,212,80,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(246,209,95,0.5)","x":["soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft","soft"],"y":[55,20,45,43.299999999999997,21,45,12,35,32,38,50,50,25,50,50,30,20,45,50,45],"type":"box","name":"soft","marker":{"color":"rgba(246,209,95,1)","line":{"color":"rgba(246,209,95,1)"}},"line":{"color":"rgba(246,209,95,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(243,205,109,0.5)","x":["soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan","soft, artisan"],"y":[45,28.5,20,50,75,22,45,45,45,45,14,40,15,45,45,48,45,50,45,45,45,48],"type":"box","name":"soft, artisan","marker":{"color":"rgba(243,205,109,1)","line":{"color":"rgba(243,205,109,1)"}},"line":{"color":"rgba(243,205,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(239,202,122,0.5)","x":["soft, artisan, blue-veined","soft, artisan, blue-veined","soft, artisan, blue-veined"],"y":[34,45,50],"type":"box","name":"soft, artisan, blue-veined","marker":{"color":"rgba(239,202,122,1)","line":{"color":"rgba(239,202,122,1)"}},"line":{"color":"rgba(239,202,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(234,199,134,0.5)","x":["soft, artisan, brined"],"y":[45],"type":"box","name":"soft, artisan, brined","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"line":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(230,196,146,0.5)","x":["soft, artisan, smear-ripened"],"y":[12],"type":"box","name":"soft, artisan, smear-ripened","marker":{"color":"rgba(230,196,146,1)","line":{"color":"rgba(230,196,146,1)"}},"line":{"color":"rgba(230,196,146,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(223,194,152,0.5)","x":["soft, artisan, soft-ripened","soft, artisan, soft-ripened","soft, artisan, soft-ripened","soft, artisan, soft-ripened","soft, artisan, soft-ripened","soft, artisan, soft-ripened","soft, artisan, soft-ripened"],"y":[10,27,28,45,35,12,27],"type":"box","name":"soft, artisan, soft-ripened","marker":{"color":"rgba(223,194,152,1)","line":{"color":"rgba(223,194,152,1)"}},"line":{"color":"rgba(223,194,152,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(216,191,157,0.5)","x":["soft, blue-veined","soft, blue-veined","soft, blue-veined","soft, blue-veined","soft, blue-veined","soft, blue-veined","soft, blue-veined","soft, blue-veined","soft, blue-veined"],"y":[43.299999999999997,30,37,54,60,60,37,40,60],"type":"box","name":"soft, blue-veined","marker":{"color":"rgba(216,191,157,1)","line":{"color":"rgba(216,191,157,1)"}},"line":{"color":"rgba(216,191,157,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(209,189,161,0.5)","x":["soft, brined","soft, brined"],"y":[21,55],"type":"box","name":"soft, brined","marker":{"color":"rgba(209,189,161,1)","line":{"color":"rgba(209,189,161,1)"}},"line":{"color":"rgba(209,189,161,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(202,186,166,0.5)","x":["soft, processed","soft, processed"],"y":[60,45],"type":"box","name":"soft, processed","marker":{"color":"rgba(202,186,166,1)","line":{"color":"rgba(202,186,166,1)"}},"line":{"color":"rgba(202,186,166,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(195,184,170,0.5)","x":["soft, semi-soft, artisan"],"y":[50],"type":"box","name":"soft, semi-soft, artisan","marker":{"color":"rgba(195,184,170,1)","line":{"color":"rgba(195,184,170,1)"}},"line":{"color":"rgba(195,184,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(187,181,175,0.5)","x":["soft, semi-soft, soft-ripened"],"y":[50],"type":"box","name":"soft, semi-soft, soft-ripened","marker":{"color":"rgba(187,181,175,1)","line":{"color":"rgba(187,181,175,1)"}},"line":{"color":"rgba(187,181,175,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(179,179,179,0.5)","x":["soft, soft-ripened","soft, soft-ripened","soft, soft-ripened","soft, soft-ripened","soft, soft-ripened","soft, soft-ripened","soft, soft-ripened","soft, soft-ripened","soft, soft-ripened"],"y":[70,30,30,60,26,28,27,27,26],"type":"box","name":"soft, soft-ripened","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(cheeses_clean, <span class="at">x =</span> <span class="sc">~</span>fat_content, <span class="at">y =</span> <span class="sc">~</span>calcium_content, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Cheese:"</span>, cheese, <span class="st">"&lt;br&gt;Milk Type:"</span>, milk), <span class="at">color =</span> <span class="sc">~</span>milk) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Fat vs Calcium Content"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Fat Content (%)"</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Calcium Content (mg)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RColorBrewer::brewer.pal(N, "Set2"): n too large, allowed maximum for palette Set2 is 8
Returning the palette you asked for with that many colors
Warning in RColorBrewer::brewer.pal(N, "Set2"): n too large, allowed maximum for palette Set2 is 8
Returning the palette you asked for with that many colors</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c10a83ce51383af1f8c4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c10a83ce51383af1f8c4">{"x":{"visdat":{"16c8241c462b7":["function () ","plotlyVisDat"]},"cur_data":"16c8241c462b7","attrs":{"16c8241c462b7":{"x":{},"y":{},"mode":"markers","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Fat vs Calcium Content","xaxis":{"domain":[0,1],"automargin":true,"title":"Fat Content (%)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Calcium Content (mg)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[25.800000000000001],"y":[469],"mode":"markers","text":"Cheese: Paesanella Buffalo Mozzarella <br>Milk Type: buffalo, cow","type":"scatter","name":"buffalo, cow","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[22],"y":[469],"mode":"markers","text":"Cheese: Caravane <br>Milk Type: camel","type":"scatter","name":"camel","marker":{"color":"rgba(211,164,122,1)","line":{"color":"rgba(211,164,122,1)"}},"textfont":{"color":"rgba(211,164,122,1)"},"error_y":{"color":"rgba(211,164,122,1)"},"error_x":{"color":"rgba(211,164,122,1)"},"line":{"color":"rgba(211,164,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[40,50,50,12,14,55,50,45,34,34,34,34,34,48,33.5,45,46,46,30,54.229999999999997,25,34,34,34,48,32,43,28.5,28,25.219999999999999,20,25.5,45,43.299999999999997,62,50,8,70,15,32.5,45,30,37,30,31,20,43.299999999999997,45,60,35,25,7,45,75,40,30,45,50,8,45,48,30,60,50,50,45,27,50,12,33,26,28,28,45,55,45,45,14,45,45,51,60,40,48,28,32,38,50,40,49,30,50,42,45,48,45,34,29.800000000000001,23,45,50,35,48,35,27,45,40,50,31,60,12,50,50,45,50,37,30,25.399999999999999,18.399999999999999,50,50,28,60,50,25,50,45,40,50,55,50,40,45,27,27,45,40,72.700000000000003,45,0,30.5,18.300000000000001,32.299999999999997,40.5,45,45,60,30,45,45,34.399999999999999,45,51,25,17,48,45,7.7999999999999998],"y":[469,469,469,469,469,26,469,469,469,469,469,469,469,469,469,469,488,492,492,469,469,469,469,469,469,469,469,469,469,469,469,700,469,450,469,469,469,469,469,725,469,469,469,469,469,469,430,469,469,469,469,90,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,497,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,190,469,469,469,469,469,469,469,469,469,30,921,1071,749,157,469,469,469,469,469,469,740,469,469,469,469,469,469,469],"mode":"markers","text":["Cheese: Abbaye de Belval <br>Milk Type: cow","Cheese: Abbaye du Mont des Cats <br>Milk Type: cow","Cheese: Adelost <br>Milk Type: cow","Cheese: ADL Brick Cheese <br>Milk Type: cow","Cheese: ADL Mild Cheddar <br>Milk Type: cow","Cheese: Affidelice au Chablis <br>Milk Type: cow","Cheese: Aisy Cendre <br>Milk Type: cow","Cheese: Allgauer Emmentaler <br>Milk Type: cow","Cheese: Alma Vorarlberger Alpkäse (3-5 months) <br>Milk Type: cow","Cheese: Alma Vorarlberger Alpkäse (6-9 months) <br>Milk Type: cow","Cheese: Alma Vorarlberger Bergkäse (10 months) <br>Milk Type: cow","Cheese: Alma Vorarlberger Bergkäse (12 months) <br>Milk Type: cow","Cheese: Alma Vorarlberger Bergkäse (6 months) <br>Milk Type: cow","Cheese: Alps Rebel <br>Milk Type: cow","Cheese: Alta Badia <br>Milk Type: cow","Cheese: Ami du Chambertin <br>Milk Type: cow","Cheese: Amul Emmental <br>Milk Type: cow","Cheese: Amul Gouda <br>Milk Type: cow","Cheese: Amul Pizza Mozzarella Cheese <br>Milk Type: cow","Cheese: Appleby's Double Gloucester <br>Milk Type: cow","Cheese: Ardrahan <br>Milk Type: cow","Cheese: Arådalen <br>Milk Type: cow","Cheese: Asiago DOP <br>Milk Type: cow","Cheese: Asiago d’Allevo DOP <br>Milk Type: cow","Cheese: Asiago Pressato DOP <br>Milk Type: cow","Cheese: Avonlea Clothbound Cheddar <br>Milk Type: cow","Cheese: Baby Swiss <br>Milk Type: cow","Cheese: Baguette Laonnaise <br>Milk Type: cow","Cheese: Baluchon <br>Milk Type: cow","Cheese: Barambah Organics Marinated Feta <br>Milk Type: cow","Cheese: Barberey <br>Milk Type: cow","Cheese: Basils Original Rauchkäse <br>Milk Type: cow","Cheese: Bassigny au porto <br>Milk Type: cow","Cheese: Bavaria blu <br>Milk Type: cow","Cheese: Bavarian Bergkase <br>Milk Type: cow","Cheese: Beaumont <br>Milk Type: cow","Cheese: Beemster 2% Milk <br>Milk Type: cow","Cheese: Belletoile <br>Milk Type: cow","Cheese: Bergues <br>Milk Type: cow","Cheese: Bianco <br>Milk Type: cow","Cheese: Bishop Kennedy <br>Milk Type: cow","Cheese: Bleu de Laqueuille <br>Milk Type: cow","Cheese: Bleubry <br>Milk Type: cow","Cheese: Boeren-Leidse met sleutels <br>Milk Type: cow","Cheese: Boivin Marbled Cheddar <br>Milk Type: cow","Cheese: Bonchester <br>Milk Type: cow","Cheese: Bonifaz <br>Milk Type: cow","Cheese: Boulette d'Avesnes <br>Milk Type: cow","Cheese: Boursin <br>Milk Type: cow","Cheese: Bra Duro DOP <br>Milk Type: cow","Cheese: Braudostur <br>Milk Type: cow","Cheese: Breakfast Cheese <br>Milk Type: cow","Cheese: Brie de Melun <br>Milk Type: cow","Cheese: Brillat-Savarin <br>Milk Type: cow","Cheese: Brin <br>Milk Type: cow","Cheese: Brise du Matin <br>Milk Type: cow","Cheese: Bruder Basil <br>Milk Type: cow","Cheese: Butterkase <br>Milk Type: cow","Cheese: Buttermilk Blue <br>Milk Type: cow","Cheese: Buxton Blue <br>Milk Type: cow","Cheese: Caerphilly <br>Milk Type: cow","Cheese: Camembert des Camarades <br>Milk Type: cow","Cheese: Caprice des Dieux <br>Milk Type: cow","Cheese: Carrot Rebel <br>Milk Type: cow","Cheese: Cave Rebel <br>Milk Type: cow","Cheese: Cendre d'Olivet <br>Milk Type: cow","Cheese: Cendré des Prés <br>Milk Type: cow","Cheese: Chaumes <br>Milk Type: cow","Cheese: ColoRouge <br>Milk Type: cow","Cheese: Colston Bassett Stilton <br>Milk Type: cow","Cheese: Comox Brie <br>Milk Type: cow","Cheese: Comox Camembert <br>Milk Type: cow","Cheese: Comtomme <br>Milk Type: cow","Cheese: Cooleney <br>Milk Type: cow","Cheese: Coquetdale <br>Milk Type: cow","Cheese: Cornish Pepper <br>Milk Type: cow","Cheese: Cotherstone <br>Milk Type: cow","Cheese: Cougar Gold <br>Milk Type: cow","Cheese: Crayeux de Roncq <br>Milk Type: cow","Cheese: Cream Havarti <br>Milk Type: cow","Cheese: Cremig Extra Würzig, Bergkäse Aus Dem Schweizer Jura <br>Milk Type: cow","Cheese: CréMonté <br>Milk Type: cow","Cheese: Cure Nantais <br>Milk Type: cow","Cheese: Curworthy <br>Milk Type: cow","Cheese: La Bonaparte <br>Milk Type: cow","Cheese: La Sauvagine <br>Milk Type: cow","Cheese: La Sauvagine Réserve <br>Milk Type: cow","Cheese: Lajta <br>Milk Type: cow","Cheese: Le Brin <br>Milk Type: cow","Cheese: Le Gruyère AOP <br>Milk Type: cow","Cheese: Leyden <br>Milk Type: cow","Cheese: Liliputas <br>Milk Type: cow","Cheese: Limburger <br>Milk Type: cow","Cheese: Llanglofan Farmhouse <br>Milk Type: cow","Cheese: Loch Arthur Farmhouse <br>Milk Type: cow","Cheese: Maasdam <br>Milk Type: cow","Cheese: Magna <br>Milk Type: cow","Cheese: Maisie's Kebbuck <br>Milk Type: cow","Cheese: Mamirolle <br>Milk Type: cow","Cheese: Mandolin <br>Milk Type: cow","Cheese: Mango Rebel <br>Milk Type: cow","Cheese: Maribo <br>Milk Type: cow","Cheese: Mature Wensleydale <br>Milk Type: cow","Cheese: McLaren <br>Milk Type: cow","Cheese: Milawa Brie <br>Milk Type: cow","Cheese: Milleens <br>Milk Type: cow","Cheese: Minas cheese <br>Milk Type: cow","Cheese: Mladi Trapist <br>Milk Type: cow","Cheese: Mont St-Benoît <br>Milk Type: cow","Cheese: Montsalvat <br>Milk Type: cow","Cheese: MouCo Truffello <br>Milk Type: cow","Cheese: Mountain Herbs Rebel <br>Milk Type: cow","Cheese: Mountain Rebel <br>Milk Type: cow","Cheese: Murol <br>Milk Type: cow","Cheese: Mycella <br>Milk Type: cow","Cheese: Météorite <br>Milk Type: cow","Cheese: Pacific Rock <br>Milk Type: cow","Cheese: Paesanella Burrata <br>Milk Type: cow","Cheese: Paesanella Fresco <br>Milk Type: cow","Cheese: Pannerone <br>Milk Type: cow","Cheese: Paprika Rebel <br>Milk Type: cow","Cheese: Passendale <br>Milk Type: cow","Cheese: Pave d'Affinois <br>Milk Type: cow","Cheese: Pave d'Auge <br>Milk Type: cow","Cheese: Peau Rouge <br>Milk Type: cow","Cheese: Peekskill Pyramid <br>Milk Type: cow","Cheese: Penbryn <br>Milk Type: cow","Cheese: Pencarreg <br>Milk Type: cow","Cheese: Pepper Rebel <br>Milk Type: cow","Cheese: Petida <br>Milk Type: cow","Cheese: Petit Pardou <br>Milk Type: cow","Cheese: Petit-Suisse <br>Milk Type: cow","Cheese: Picobello <br>Milk Type: cow","Cheese: Pied-de-vent <br>Milk Type: cow","Cheese: Pizy <br>Milk Type: cow","Cheese: Pompeii <br>Milk Type: cow","Cheese: Port Nicholson <br>Milk Type: cow","Cheese: Port-Salut <br>Milk Type: cow","Cheese: Prastost <br>Milk Type: cow","Cheese: President Fat Free Feta <br>Milk Type: cow","Cheese: Prima Donna fino <br>Milk Type: cow","Cheese: Prima Donna leggero <br>Milk Type: cow","Cheese: Prima Donna maturo <br>Milk Type: cow","Cheese: Provolone del Monaco <br>Milk Type: cow","Cheese: Saaland Pfarr <br>Milk Type: cow","Cheese: Sage Derby <br>Milk Type: cow","Cheese: Saint Agur <br>Milk Type: cow","Cheese: Samso <br>Milk Type: cow","Cheese: Sbrinz <br>Milk Type: cow","Cheese: Selva <br>Milk Type: cow","Cheese: Seriously Strong Cheddar <br>Milk Type: cow","Cheese: Sharpham <br>Milk Type: cow","Cheese: Shelburne Cheddar <br>Milk Type: cow","Cheese: Sourire Lozerien <br>Milk Type: cow","Cheese: St Fidèle Swiss <br>Milk Type: cow","Cheese: Staffordshire Organic <br>Milk Type: cow","Cheese: Sveciaost <br>Milk Type: cow","Cheese: Swiss cheese <br>Milk Type: cow"],"type":"scatter","name":"cow","marker":{"color":"rgba(229,147,127,1)","line":{"color":"rgba(229,147,127,1)"}},"textfont":{"color":"rgba(229,147,127,1)"},"error_y":{"color":"rgba(229,147,127,1)"},"error_x":{"color":"rgba(229,147,127,1)"},"line":{"color":"rgba(229,147,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[25,40,27,24,14,27,8],"y":[469,469,360,469,469,469,469],"mode":"markers","text":["Cheese: Aromes au Gene de Marc <br>Milk Type: cow, goat","Cheese: Autun <br>Milk Type: cow, goat","Cheese: Brunost <br>Milk Type: cow, goat","Cheese: Chèvre des neiges <br>Milk Type: cow, goat","Cheese: Cremont <br>Milk Type: cow, goat","Cheese: Le Double Joie <br>Milk Type: cow, goat","Cheese: Seascape <br>Milk Type: cow, goat"],"type":"scatter","name":"cow, goat","marker":{"color":"rgba(156,159,194,1)","line":{"color":"rgba(156,159,194,1)"}},"textfont":{"color":"rgba(156,159,194,1)"},"error_y":{"color":"rgba(156,159,194,1)"},"error_x":{"color":"rgba(156,159,194,1)"},"line":{"color":"rgba(156,159,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[22,45,34.200000000000003],"y":[469,469,4768],"mode":"markers","text":["Cheese: Baladi <br>Milk Type: cow, goat, sheep","Cheese: Bica de Queijo <br>Milk Type: cow, goat, sheep","Cheese: Castelmagno <br>Milk Type: cow, goat, sheep"],"type":"scatter","name":"cow, goat, sheep","marker":{"color":"rgba(194,150,199,1)","line":{"color":"rgba(194,150,199,1)"}},"textfont":{"color":"rgba(194,150,199,1)"},"error_y":{"color":"rgba(194,150,199,1)"},"error_x":{"color":"rgba(194,150,199,1)"},"line":{"color":"rgba(194,150,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[30,54,46,55,45,40,50,40],"y":[469,469,469,469,469,469,469,469],"mode":"markers","text":["Cheese: Blenda <br>Milk Type: cow, sheep","Cheese: Blu Della Casera <br>Milk Type: cow, sheep","Cheese: Burgos <br>Milk Type: cow, sheep","Cheese: Cacio di Bosco al Tartufo <br>Milk Type: cow, sheep","Cheese: Casciotta di Urbino <br>Milk Type: cow, sheep","Cheese: Manur <br>Milk Type: cow, sheep","Cheese: Matocq <br>Milk Type: cow, sheep","Cheese: Podhalanski <br>Milk Type: cow, sheep"],"type":"scatter","name":"cow, sheep","marker":{"color":"rgba(223,155,177,1)","line":{"color":"rgba(223,155,177,1)"}},"textfont":{"color":"rgba(223,155,177,1)"},"error_y":{"color":"rgba(223,155,177,1)"},"error_x":{"color":"rgba(223,155,177,1)"},"line":{"color":"rgba(223,155,177,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[26,45,20.800000000000001],"y":[343,469,208],"mode":"markers","text":["Cheese: Amul Processed Cheese <br>Milk Type: cow, water buffalo","Cheese: Mozzarella (Australian) <br>Milk Type: cow, water buffalo","Cheese: Paneer <br>Milk Type: cow, water buffalo"],"type":"scatter","name":"cow, water buffalo","marker":{"color":"rgba(182,204,108,1)","line":{"color":"rgba(182,204,108,1)"}},"textfont":{"color":"rgba(182,204,108,1)"},"error_y":{"color":"rgba(182,204,108,1)"},"error_x":{"color":"rgba(182,204,108,1)"},"line":{"color":"rgba(182,204,108,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[45,45,39.600000000000001,11,21,50,10,45,45,26,12,45,45,40,5,45,25,50,45,45,22,26,45,45,45,40,18.199999999999999,14,36],"y":[469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469],"mode":"markers","text":["Cheese: Allium Piper <br>Milk Type: goat","Cheese: Anneau du Vic-Bilh <br>Milk Type: goat","Cheese: Bettine Bleu <br>Milk Type: goat","Cheese: Bijou <br>Milk Type: goat","Cheese: Bonne Bouche <br>Milk Type: goat","Cheese: Bougon <br>Milk Type: goat","Cheese: Bucheret <br>Milk Type: goat","Cheese: Buchette d'Anjou <br>Milk Type: goat","Cheese: Bûchette à la Sarriette <br>Milk Type: goat","Cheese: Caprano <br>Milk Type: goat","Cheese: Chavroux <br>Milk Type: goat","Cheese: Chevrotin des Aravis <br>Milk Type: goat","Cheese: Civray <br>Milk Type: goat","Cheese: Corleggy <br>Milk Type: goat","Cheese: Cracked Pepper Chevre <br>Milk Type: goat","Cheese: La Taupiniere <br>Milk Type: goat","Cheese: Le Cendrillon <br>Milk Type: goat","Cheese: Le Chevrot <br>Milk Type: goat","Cheese: Lemon Myrtle Chevre <br>Milk Type: goat","Cheese: Manon <br>Milk Type: goat","Cheese: Monet <br>Milk Type: goat","Cheese: Paillot de Chèvre <br>Milk Type: goat","Cheese: Pelardon des Corbieres <br>Milk Type: goat","Cheese: Pourly <br>Milk Type: goat","Cheese: Saltbush Chevre <br>Milk Type: goat","Cheese: Sancerre <br>Milk Type: goat","Cheese: St Tola Cranberry <br>Milk Type: goat","Cheese: St Tola Divine <br>Milk Type: goat","Cheese: St Tola Hard Cheese <br>Milk Type: goat"],"type":"scatter","name":"goat","marker":{"color":"rgba(209,217,69,1)","line":{"color":"rgba(209,217,69,1)"}},"textfont":{"color":"rgba(209,217,69,1)"},"error_y":{"color":"rgba(209,217,69,1)"},"error_x":{"color":"rgba(209,217,69,1)"},"line":{"color":"rgba(209,217,69,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[40,45,8,30,20,20,40,45,50,45,36,50],"y":[469,469,469,318,469,469,469,469,469,469,469,469],"mode":"markers","text":["Cheese: Alverca <br>Milk Type: goat, sheep","Cheese: Amarelo de Beira Baixa <br>Milk Type: goat, sheep","Cheese: Anari <br>Milk Type: goat, sheep","Cheese: Anthotyro <br>Milk Type: goat, sheep","Cheese: Anthotyro Fresco <br>Milk Type: goat, sheep","Cheese: Batzos <br>Milk Type: goat, sheep","Cheese: Brocciu <br>Milk Type: goat, sheep","Cheese: Castelo Branco <br>Milk Type: goat, sheep","Cheese: Le Fium Orbo <br>Milk Type: goat, sheep","Cheese: Lebbene <br>Milk Type: goat, sheep","Cheese: Manouri <br>Milk Type: goat, sheep","Cheese: Pate de Fromage <br>Milk Type: goat, sheep"],"type":"scatter","name":"goat, sheep","marker":{"color":"rgba(253,215,61,1)","line":{"color":"rgba(253,215,61,1)"}},"textfont":{"color":"rgba(253,215,61,1)"},"error_y":{"color":"rgba(253,215,61,1)"},"error_x":{"color":"rgba(253,215,61,1)"},"line":{"color":"rgba(253,215,61,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[12],"y":[469],"mode":"markers","text":"Cheese: Moose <br>Milk Type: moose","type":"scatter","name":"moose","marker":{"color":"rgba(237,202,125,1)","line":{"color":"rgba(237,202,125,1)"}},"textfont":{"color":"rgba(237,202,125,1)"},"error_y":{"color":"rgba(237,202,125,1)"},"error_x":{"color":"rgba(237,202,125,1)"},"line":{"color":"rgba(237,202,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[45,52,45,45,50,20,50,26,45,48,48,50,45,13,45,40,48],"y":[469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469],"mode":"markers","text":["Cheese: Abertam <br>Milk Type: sheep","Cheese: Acorn <br>Milk Type: sheep","Cheese: Amou <br>Milk Type: sheep","Cheese: Ardi Gasna <br>Milk Type: sheep","Cheese: Baskeriu <br>Milk Type: sheep","Cheese: Cacio De Roma® <br>Milk Type: sheep","Cheese: La Serena <br>Milk Type: sheep","Cheese: Le Brebiou <br>Milk Type: sheep","Cheese: Le Lacandou <br>Milk Type: sheep","Cheese: Leafield <br>Milk Type: sheep","Cheese: Little Rydings <br>Milk Type: sheep","Cheese: Malvern <br>Milk Type: sheep","Cheese: Mihalic Peynir <br>Milk Type: sheep","Cheese: MitiCaña® de Oveja <br>Milk Type: sheep","Cheese: P'tit Basque <br>Milk Type: sheep","Cheese: Pecorino in Walnut Leaves <br>Milk Type: sheep","Cheese: Shepherd's Crook <br>Milk Type: sheep"],"type":"scatter","name":"sheep","marker":{"color":"rgba(212,190,160,1)","line":{"color":"rgba(212,190,160,1)"}},"textfont":{"color":"rgba(212,190,160,1)"},"error_y":{"color":"rgba(212,190,160,1)"},"error_x":{"color":"rgba(212,190,160,1)"},"line":{"color":"rgba(212,190,160,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[21,45],"y":[469,316],"mode":"markers","text":["Cheese: Mozzarella di Bufala DOP <br>Milk Type: water buffalo","Cheese: Provoleta <br>Milk Type: water buffalo"],"type":"scatter","name":"water buffalo","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[30,15,35,30,20,33],"y":[469,469,469,469,469,990],"mode":"markers","text":["Cheese: Amsterdammer (British Columbia) <br>Milk Type: NA","Cheese: L'Empereur <br>Milk Type: NA","Cheese: L'Étoile de St-Raymond <br>Milk Type: NA","Cheese: Le Reflet de Portneuf <br>Milk Type: NA","Cheese: Le St-Raymond <br>Milk Type: NA","Cheese: Prima Donna forte <br>Milk Type: NA"],"type":"scatter","name":"NA","marker":{"color":"transparent","line":{"color":"transparent"}},"textfont":{"color":"transparent"},"error_y":{"color":"transparent"},"error_x":{"color":"transparent"},"line":{"color":"transparent"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>region_counts <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(region, type) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(region_counts, <span class="at">x =</span> <span class="sc">~</span>region, <span class="at">y =</span> <span class="sc">~</span>type, <span class="at">z =</span> <span class="sc">~</span>n, <span class="at">type =</span> <span class="st">"heatmap"</span>, <span class="at">colorscale =</span> <span class="st">"Viridis"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Cheese Type by Region"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Region"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Cheese Type"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-344b29a0718d5f2a1c98" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-344b29a0718d5f2a1c98">{"x":{"visdat":{"16c8265df033b":["function () ","plotlyVisDat"]},"cur_data":"16c8265df033b","attrs":{"16c8265df033b":{"x":{},"y":{},"z":{},"colorscale":"Viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cheese Type by Region","xaxis":{"domain":[0,1],"automargin":true,"title":"Region","tickangle":45,"type":"category","categoryorder":"array","categoryarray":["All Holland","Allgaeu Alps","Amou, Gascony","Anjou","Auvergne","Avesnes","Aveyron","Basque, Pyrenees Mountains","Bavaria","Beara Peninsula, Co. Cork","Beira Baixa Province","Belvederis","Bergues","Bethania","Bjurholm","Bornholm","Bregenzerwald, Kleinwalsertal, Großwalsertal, Laiblachtal (Pfänderstock) and Rheintal","Brisbane","British Columbia","Brittany","Burgund","Burgundy","Bursa","Buxton, Derbyshire","California","Campania, Paestum, Foggia","Castelo Branco, Fundão and Idanha-a-Nova","Castille-Leon","Central and Western Macedonia, Thessalia","Central and Western Macedonia, Thessaly","Centre-Val de Loire","Cevenes","Charm, Ohio","Colorado","Comox Valley, Vancouver Island","Coquet","Corsica","Cotherstone","County Cavan","Croisy-sur-Eure","Dalmatia","Devon","Duchy of Limburg","Duhallow","Dumfries","East Midlands","Emilia-Romagna","Extremadura","Fornells de la Selva, Gironès","French Basque Country, Midi-Pyrénées","Gevrey-Chambertin, Burgundy","Gloucestershire","Gujarat","Haute-Savoie / Upper Savoy","Huizen","Ile de France","Ile-de-France/Champagne","Illoud (Haute-Marne)","Inagh, Co Clare","island wide","Jura","Karlovy Vary","Kinfauns, Perthshire","Lanarkshire","Landshut","Languedoc-Roussillon","Laqueuille","Laruns","Leiden","Lodi","Loire","Loire Valley","Low-laying regions","Lucerne, Schwyz, Unterwald, and Zoug, and the following additional places: Muri district in d'Argovi","Macedonia, Thrace, Thessalia, Peloponissos, Ionian Islands, Aegean islands, Crete Island and Epirus","Maribo","Midi-Pyrénées","Minas Gerais","Murcia","Naples","New York","Nord-Pas-de-Calais","Normandy, Auvilliers","North East Victoria","North Wootton","North Yorkshire","Oviken","Oxfordshire","Passendale","Peekskill","Pembrokeshire","Pesaro-Urbino","Piedmont","Plessisville, Quebec","Poitou-Charentes","Póvoa de Lanhoso","Prince Edward Island","Pullman, Washington","Pyrenees-Atlantiques","Pyrénées-Atlantiques","Quebec","Québec","Rhône-Alpes","Rhone-Alps","Roncq","Roxburghshire","Severn Valley","Shelburne Farms","Somerset","South Australia","St Antoine","Staffordshire","Stranraer","Sulzberg","Swabia","Tipperary","Troyes , Aube","Tuscany","Veneto","Veneto, Trentino","Vermont","Vorarlberg","Wales","Wales, London","Websterville, VT","Wisconsin"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Cheese Type","type":"category","categoryorder":"array","categoryarray":["firm","firm, artisan","firm, artisan, blue-veined","firm, artisan, brined","fresh firm, artisan","fresh firm, soft-ripened","fresh soft","fresh soft, artisan","fresh soft, hard, artisan","fresh soft, whey","hard","hard, artisan","hard, processed","hard, semi-hard","hard, whey","semi-firm, artisan","semi-hard","semi-hard, artisan","semi-hard, artisan, smear-ripened","semi-hard, blue-veined","semi-hard, brined","semi-hard, soft-ripened","semi-soft","semi-soft, artisan","semi-soft, artisan, brined","semi-soft, artisan, soft-ripened","semi-soft, blue-veined","semi-soft, brined","semi-soft, firm","semi-soft, processed","semi-soft, smear-ripened","semi-soft, soft-ripened","semi-soft, whey","soft","soft, artisan","soft, artisan, blue-veined","soft, artisan, brined","soft, artisan, smear-ripened","soft, artisan, soft-ripened","soft, blue-veined","soft, brined","soft, processed","soft, semi-soft, artisan","soft, semi-soft, soft-ripened","soft, soft-ripened"]},"scene":{"zaxis":{"title":"n"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"n","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"Viridis","showscale":true,"x":["All Holland","Allgaeu Alps","Amou, Gascony","Anjou","Auvergne","Avesnes","Aveyron","Basque, Pyrenees Mountains","Bavaria","Beara Peninsula, Co. Cork","Beira Baixa Province","Belvederis","Bergues","Bethania","Bjurholm","Bornholm","Bregenzerwald, Kleinwalsertal, Großwalsertal, Laiblachtal (Pfänderstock) and Rheintal","Brisbane","British Columbia","Brittany","Burgund","Burgundy","Burgundy","Burgundy","Bursa","Buxton, Derbyshire","California","California","California","Campania, Paestum, Foggia","Castelo Branco, Fundão and Idanha-a-Nova","Castille-Leon","Central and Western Macedonia, Thessalia","Central and Western Macedonia, Thessaly","Centre-Val de Loire","Cevenes","Charm, Ohio","Colorado","Colorado","Colorado","Comox Valley, Vancouver Island","Coquet","Corsica","Cotherstone","County Cavan","Croisy-sur-Eure","Dalmatia","Devon","Devon","Duchy of Limburg","Duhallow","Dumfries","East Midlands","Emilia-Romagna","Extremadura","Fornells de la Selva, Gironès","French Basque Country, Midi-Pyrénées","Gevrey-Chambertin, Burgundy","Gloucestershire","Gujarat","Gujarat","Gujarat","Haute-Savoie / Upper Savoy","Huizen","Ile de France","Ile de France","Ile-de-France/Champagne","Illoud (Haute-Marne)","Inagh, Co Clare","Inagh, Co Clare","Jura","Karlovy Vary","Kinfauns, Perthshire","Lanarkshire","Landshut","Languedoc-Roussillon","Laqueuille","Laruns","Leiden","Leiden","Lodi","Loire","Loire Valley","Low-laying regions","Lucerne, Schwyz, Unterwald, and Zoug, and the following additional places: Muri district in d'Argovi","Macedonia, Thrace, Thessalia, Peloponissos, Ionian Islands, Aegean islands, Crete Island and Epirus","Macedonia, Thrace, Thessalia, Peloponissos, Ionian Islands, Aegean islands, Crete Island and Epirus","Maribo","Midi-Pyrénées","Minas Gerais","Murcia","Naples","New York","Nord-Pas-de-Calais","Normandy, Auvilliers","North East Victoria","North Wootton","North Yorkshire","Oviken","Oviken","Oviken","Oxfordshire","Passendale","Peekskill","Pembrokeshire","Pesaro-Urbino","Piedmont","Piedmont","Piedmont","Plessisville, Quebec","Poitou-Charentes","Prince Edward Island","Prince Edward Island","Prince Edward Island","Pullman, Washington","Pyrenees-Atlantiques","Pyrénées-Atlantiques","Póvoa de Lanhoso","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Quebec","Québec","Rhone-Alps","Rhône-Alpes","Rhône-Alpes","Roncq","Roxburghshire","Severn Valley","Shelburne Farms","Somerset","South Australia","South Australia","South Australia","South Australia","St Antoine","Staffordshire","Stranraer","Sulzberg","Sulzberg","Swabia","Tipperary","Troyes , Aube","Tuscany","Veneto","Veneto","Veneto, Trentino","Vermont","Vermont","Vorarlberg","Wales","Wales, London","Websterville, VT","Wisconsin","island wide"],"y":["semi-hard","hard, artisan","firm","soft, artisan","soft, blue-veined","fresh soft","soft, artisan","semi-hard, artisan","semi-soft, artisan","soft, artisan","semi-firm, artisan","semi-hard","semi-hard","hard, artisan","fresh soft","soft, artisan, blue-veined","hard, artisan","fresh soft","soft, soft-ripened","semi-soft","soft, artisan","fresh soft, artisan","semi-soft, smear-ripened","soft","hard, artisan","soft, artisan, blue-veined","fresh firm, soft-ripened","semi-hard, artisan","soft, artisan, soft-ripened","soft, brined","semi-soft, artisan","fresh soft","semi-soft, whey","semi-hard","soft, artisan","semi-soft, artisan","semi-soft, processed","semi-soft, artisan","soft, artisan, smear-ripened","soft, artisan, soft-ripened","semi-soft, firm","semi-hard, soft-ripened","fresh soft, whey","semi-hard, artisan","hard, artisan","soft, processed","semi-hard, artisan","semi-hard","soft, artisan","semi-soft, smear-ripened","semi-soft, brined","hard","semi-hard, artisan","hard, artisan","soft","soft, artisan","semi-soft","semi-soft, artisan, brined","hard, artisan","hard, processed","semi-hard","semi-soft, processed","soft, artisan, brined","hard","semi-soft, soft-ripened","soft, artisan","soft, artisan","soft, soft-ripened","fresh soft, artisan","hard, artisan","hard, artisan","hard, artisan","soft","semi-hard, artisan","soft, blue-veined","soft","soft, blue-veined","semi-hard","hard, artisan","semi-hard, artisan","soft, semi-soft, artisan","soft","soft","semi-hard, brined","hard, artisan","hard, whey","semi-soft, whey","semi-hard, artisan","hard, artisan","semi-soft, artisan","semi-soft, soft-ripened","semi-hard, artisan","firm, artisan, brined","semi-soft, artisan, brined","fresh soft","soft, soft-ripened","soft, artisan","hard, artisan","firm, artisan, blue-veined","hard, artisan","soft, artisan, blue-veined","hard, artisan","semi-soft, soft-ripened","soft, artisan","hard, artisan","semi-soft, artisan","hard","semi-hard","soft, blue-veined","semi-soft, artisan","soft, artisan","hard, artisan","semi-hard","semi-soft","semi-soft","soft, artisan","semi-soft, artisan, soft-ripened","semi-soft, artisan","firm, artisan","fresh soft","hard","hard, semi-hard","semi-hard","semi-soft","semi-soft, blue-veined","semi-soft, processed","soft","soft, artisan","soft, artisan, soft-ripened","soft, blue-veined","soft, soft-ripened","semi-soft, artisan","semi-soft, artisan","semi-soft","semi-soft, artisan","soft, artisan, soft-ripened","soft, artisan","semi-hard, artisan","hard, artisan","soft, artisan","fresh firm, artisan","fresh soft, artisan","semi-hard, artisan, smear-ripened","soft, artisan, soft-ripened","soft, semi-soft, soft-ripened","hard, artisan","hard","hard, artisan","semi-hard, artisan","hard","soft, artisan","soft","semi-firm, artisan","hard","semi-soft","hard","soft","soft, artisan","hard, artisan","soft, blue-veined","hard","semi-soft, artisan","semi-hard, blue-veined","fresh soft, hard, artisan"],"z":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,6,1,3,2,5,1,2,1,1,1,1,1,1,1,2,3,2,1,1,1,1,1,7,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1],"type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemapify)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>cheese_family_counts <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(family, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(cheese_family_counts, <span class="at">type =</span> <span class="st">'treemap'</span>, </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="sc">~</span>family, <span class="at">parents =</span> <span class="cn">NA</span>, <span class="at">values =</span> <span class="sc">~</span>n,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">textinfo =</span> <span class="st">"label+value+percent entry"</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#8dd3c7"</span>, <span class="st">"#ffffb3"</span>, <span class="st">"#bebada"</span>, <span class="st">"#fb8072"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Cheese Family Diversity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-98fc3342032009c8badd" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-98fc3342032009c8badd">{"x":{"visdat":{"16c825e65c8b4":["function () ","plotlyVisDat"]},"cur_data":"16c825e65c8b4","attrs":{"16c825e65c8b4":{"labels":{},"parents":null,"values":{},"textinfo":"label+value+percent entry","marker":{"colors":["#8dd3c7","#ffffb3","#bebada","#fb8072"]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"treemap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cheese Family Diversity","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["Blue","Brie","Cheddar","Gouda","Swiss Cheese","Camembert","Cottage","Parmesan","Pasta filata","Feta","Mozzarella","Pecorino","Tomme","Caciotta","Cornish","Havarti"],"parents":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"values":[14,14,11,8,7,4,4,4,4,3,3,2,2,1,1,1],"textinfo":"label+value+percent entry","marker":{"color":"rgba(31,119,180,1)","colors":["#8dd3c7","#ffffb3","#bebada","#fb8072"],"line":{"color":"rgba(255,255,255,1)"}},"type":"treemap","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'maps'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    map</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count cheeses by country</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>cheese_country <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get map data with latitude and longitude</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>world_coords <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lat =</span> <span class="fu">mean</span>(lat), <span class="at">long =</span> <span class="fu">mean</span>(long))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Join coordinates with cheese_country data</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>cheese_country_coords <span class="ot">&lt;-</span> cheese_country <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(world_coords, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span> <span class="ot">=</span> <span class="st">"region"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()  <span class="co"># Remove rows where lat/long couldn't be matched</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a color palette based on the number of cheeses</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">domain =</span> cheese_country_coords<span class="sc">$</span>n)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive map</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(<span class="at">data =</span> cheese_country_coords) <span class="sc">%&gt;%</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>long, <span class="at">lat =</span> <span class="sc">~</span>lat, <span class="co"># Use latitude and longitude</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="sc">~</span>n <span class="sc">/</span> <span class="dv">10</span>, </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(country, <span class="st">"&lt;br&gt;Number of Cheeses:"</span>, n),</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span><span class="fu">pal</span>(n), <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">fillOpacity =</span> <span class="fl">0.7</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">pal =</span> pal,</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="sc">~</span>n,</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Cheeses"</span>,</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="dv">1</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-0099a388f82a5d0ec01f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0099a388f82a5d0ec01f">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[-37.65934036372371,-25.1829968212448,47.57973189914928,50.59062728413775,-9.802374640273754,65.29312210129171,44.64204021188665,35.06383926391602,49.88403902053833,55.70473306131043,46.16686105018805,51.20460854785544,38.35875267119733,47.23226486633871,65.30841881286756,23.39336982137758,53.49476024082728,31.8765000479562,42.16598249235487,55.08303815780148,19.77547650619459,52.09904686948087,-40.86267866811441,51.40997793704649,39.93083947704685,44.2524472068758,40.67995297908783,61.89590923058442,46.74156613273416,39.06608086718359],[-65.45939024557157,136.9985434157885,13.47336568551905,4.73210363007762,-55.28056799486391,-89.75617590060136,16.34878585682834,33.35030769348145,15.42377680937449,10.73125458083697,3.226979203100409,10.40115605525567,23.94053688131974,19.42393128225736,-19.8672900189364,83.51400315054786,-8.439389413500587,35.21034702119373,11.75285266441434,24.08004028566422,-11.62138300892721,5.322302248461026,147.1987909723098,19.08651571937755,-7.887035126327186,20.75116897611582,-2.906820906168191,17.57630542317692,8.312952255820209,34.29492853035705],[0.1,1.4,1.3,0.2,0.1,3.2,0.1,0.1,0.1,0.4,5.4,1,0.4,0.1,0.1,0.4,0.6,0.1,1.4,0.1,0.1,0.9,0.1,0.1,0.4,0.1,0.4,0.8,0.3,0.1],null,null,{"interactive":true,"className":"","stroke":true,"color":["#F7FBFF","#C7DCEF","#CBDEF1","#F3F9FE","#F7FBFF","#509BCB","#F7FBFF","#F7FBFF","#F7FBFF","#ECF4FB","#08306B","#D5E5F4","#ECF4FB","#F7FBFF","#F7FBFF","#ECF4FB","#E4EFF9","#F7FBFF","#C7DCEF","#F7FBFF","#F7FBFF","#D9E8F5","#F7FBFF","#F7FBFF","#ECF4FB","#F7FBFF","#ECF4FB","#DDEAF7","#EFF6FD","#F7FBFF"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#F7FBFF","#C7DCEF","#CBDEF1","#F3F9FE","#F7FBFF","#509BCB","#F7FBFF","#F7FBFF","#F7FBFF","#ECF4FB","#08306B","#D5E5F4","#ECF4FB","#F7FBFF","#F7FBFF","#ECF4FB","#E4EFF9","#F7FBFF","#C7DCEF","#F7FBFF","#F7FBFF","#D9E8F5","#F7FBFF","#F7FBFF","#ECF4FB","#F7FBFF","#ECF4FB","#DDEAF7","#EFF6FD","#F7FBFF"],"fillOpacity":0.7},null,null,["Argentina <br>Number of Cheeses: 1","Australia <br>Number of Cheeses: 14","Austria <br>Number of Cheeses: 13","Belgium <br>Number of Cheeses: 2","Brazil <br>Number of Cheeses: 1","Canada <br>Number of Cheeses: 32","Croatia <br>Number of Cheeses: 1","Cyprus <br>Number of Cheeses: 1","Czech Republic <br>Number of Cheeses: 1","Denmark <br>Number of Cheeses: 4","France <br>Number of Cheeses: 54","Germany <br>Number of Cheeses: 10","Greece <br>Number of Cheeses: 4","Hungary <br>Number of Cheeses: 1","Iceland <br>Number of Cheeses: 1","India <br>Number of Cheeses: 4","Ireland <br>Number of Cheeses: 6","Israel <br>Number of Cheeses: 1","Italy <br>Number of Cheeses: 14","Lithuania <br>Number of Cheeses: 1","Mauritania <br>Number of Cheeses: 1","Netherlands <br>Number of Cheeses: 9","New Zealand <br>Number of Cheeses: 1","Poland <br>Number of Cheeses: 1","Portugal <br>Number of Cheeses: 4","Serbia <br>Number of Cheeses: 1","Spain <br>Number of Cheeses: 4","Sweden <br>Number of Cheeses: 8","Switzerland <br>Number of Cheeses: 3","Turkey <br>Number of Cheeses: 1"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#F7FBFF , #D5E5F4 16.9811320754717%, #A3CCE3 35.8490566037736%, #5DA3D0 54.7169811320755%, #2675B7 73.5849056603774%, #094488 92.4528301886792%, #08306B "],"labels":["10","20","30","40","50"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"numeric","title":"Number of Cheeses","extra":{"p_1":0.169811320754717,"p_n":0.9245283018867925},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[-40.86267866811441,65.30841881286756],"lng":[-89.75617590060136,147.1987909723098]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud2)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>flavor_words <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(flavor)) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, flavor) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud2</span>(flavor_words, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"random-dark"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="wordcloud2 html-widget html-fill-item" id="htmlwidget-b4c13e198213fd20f16a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b4c13e198213fd20f16a">{"x":{"word":["buttery","sweet","mild","nutty","creamy","salty","spicy","tangy","milky","acidic","strong","fruity","herbaceous","sharp","flavored","full","mushroomy","smooth","savory","sour","smokey","grassy","citrusy","piquant","subtle","bitter","caramel","earthy","garlicky","floral","mellow","pronounced","woody","butterscotch","pungent","yeasty","burnt","lemony"],"freq":[54,53,51,48,35,30,30,29,28,24,22,20,16,16,13,13,12,12,11,11,10,9,8,7,7,6,5,5,5,3,3,3,3,2,2,2,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":2.333333333333333,"backgroundColor":"white","gridSize":0,"minRotation":-0.7853981633974483,"maxRotation":0.7853981633974483,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>top_producers <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(producers, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(top_producers, <span class="at">x =</span> <span class="sc">~</span>n, <span class="at">y =</span> <span class="sc">~</span><span class="fu">reorder</span>(producers, n), <span class="at">type =</span> <span class="st">"bar"</span>, <span class="at">orientation =</span> <span class="st">"h"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Top 15 Cheese Producers"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Number of Cheeses"</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Producers"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Ignoring 1 observations</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a4639e9955263025ed0d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a4639e9955263025ed0d">{"x":{"visdat":{"16c821cab0160":["function () ","plotlyVisDat"]},"cur_data":"16c821cab0160","attrs":{"16c821cab0160":{"x":{},"y":{},"orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Top 15 Cheese Producers","xaxis":{"domain":[0,1],"automargin":true,"title":"Number of Cheeses"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Producers","type":"category","categoryorder":"array","categoryarray":["Fromagerie GUILLOTEAU","Inagh Farmhouse Cheese Ltd","Natural Pastures Cheese Company","Oviken cheese","Paesanella Cheese Manufacturers","Vermont Creamery","Gujarat Cooperative Milk Marketing Federation (Amul)","Vandersterre Groep International B.V.","Bergader Privatkäserei GmbH","Rupp AG","Various","Sulzberger Käserebellen Sennerei GmbH","Woodside Cheese Wrights","La Maison Alexis de Portneuf Inc."]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[16,8,8,5,5,5,4,4,3,3,3,3,3,3],"y":["La Maison Alexis de Portneuf Inc.","Sulzberger Käserebellen Sennerei GmbH","Woodside Cheese Wrights","Bergader Privatkäserei GmbH","Rupp AG","Various","Gujarat Cooperative Milk Marketing Federation (Amul)","Vandersterre Groep International B.V.","Fromagerie GUILLOTEAU","Inagh Farmhouse Cheese Ltd","Natural Pastures Cheese Company","Oviken cheese","Paesanella Cheese Manufacturers","Vermont Creamery"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(cheeses_clean, <span class="at">x =</span> <span class="sc">~</span>year, <span class="at">type =</span> <span class="st">"histogram"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Cheese Origin Over Time"</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Year"</span>),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Number of Cheeses"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e0d60032ac5ccacc8331" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e0d60032ac5ccacc8331">{"x":{"visdat":{"16c82655166a5":["function () ","plotlyVisDat"]},"cur_data":"16c82655166a5","attrs":{"16c82655166a5":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cheese Origin Over Time","xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Cheeses"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["structure(function (x) ","{","    UseMethod(\"year\")","}, apiSrc = TRUE)"],"type":"histogram","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Aggregate Data</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>alluvial_data <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(region), <span class="sc">!</span><span class="fu">is.na</span>(milk), <span class="sc">!</span><span class="fu">is.na</span>(family), <span class="sc">!</span><span class="fu">is.na</span>(type)) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(milk, family, region, type, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Simplify Milk Type</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>alluvial_data <span class="ot">&lt;-</span> alluvial_data <span class="sc">%&gt;%</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">milk =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(milk, <span class="st">","</span>) <span class="sc">~</span> <span class="st">"Mixed Milk"</span>,  <span class="co"># Combine mixed milk types</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> milk</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Limit to Top Regions</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>top_regions <span class="ot">&lt;-</span> alluvial_data <span class="sc">%&gt;%</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(region, <span class="at">wt =</span> n, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(region)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>alluvial_data <span class="ot">&lt;-</span> alluvial_data <span class="sc">%&gt;%</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">if_else</span>(region <span class="sc">%in%</span> top_regions, region, <span class="st">"Other"</span>))</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Limit to Top Families</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>top_families <span class="ot">&lt;-</span> alluvial_data <span class="sc">%&gt;%</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(family, <span class="at">wt =</span> n, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(family)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>alluvial_data <span class="ot">&lt;-</span> alluvial_data <span class="sc">%&gt;%</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">family =</span> <span class="fu">if_else</span>(family <span class="sc">%in%</span> top_families, family, <span class="st">"Other"</span>))</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Create the Alluvial Diagram</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alluvial_data,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> milk, <span class="at">axis2 =</span> family, <span class="at">axis3 =</span> region, <span class="at">axis4 =</span> type,</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> milk), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  <span class="co"># Adjust stratum width</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Strata bars</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">max.overlaps =</span> <span class="dv">10</span>) <span class="sc">+</span>  <span class="co"># Improved text labels</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Milk Type"</span>, <span class="st">"Cheese Family"</span>, <span class="st">"Region"</span>, <span class="st">"Type"</span>)) <span class="sc">+</span>  <span class="co"># Axis labels</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"D"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Colorblind-friendly palette</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cheese Characteristics Alluvial Diagram"</span>,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Visualizing relationships across key attributes of cheese"</span>,</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Cheeses"</span>,</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Attributes"</span>,  <span class="co"># Add an axis label for clarity</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Milk Type"</span>  <span class="co"># Improve legend title</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">70</span>, <span class="at">label =</span> <span class="st">"Milk Type"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">70</span>, <span class="at">label =</span> <span class="st">"Cheese Family"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">70</span>, <span class="at">label =</span> <span class="st">"Region"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">70</span>, <span class="at">label =</span> <span class="st">"Type"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span>  <span class="co"># Increase base font size for better readability</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># Rotate x-axis labels</span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,  <span class="co"># Move legend to top</span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"vertical"</span>,  <span class="co"># Stack legend items vertically</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),  <span class="co"># Adjust key size</span></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Improve legend title size</span></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)  <span class="co"># Improve legend text size</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in to_lodes_form(data = data, axes = axis_ind, discern =
params$discern): Some strata appear at multiple axes.
Warning in to_lodes_form(data = data, axes = axis_ind, discern =
params$discern): Some strata appear at multiple axes.
Warning in to_lodes_form(data = data, axes = axis_ind, discern =
params$discern): Some strata appear at multiple axes.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot with larger dimensions</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"alluvial_diagram.png"</span>, <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in to_lodes_form(data = data, axes = axis_ind, discern =
params$discern): Some strata appear at multiple axes.
Warning in to_lodes_form(data = data, axes = axis_ind, discern =
params$discern): Some strata appear at multiple axes.
Warning in to_lodes_form(data = data, axes = axis_ind, discern =
params$discern): Some strata appear at multiple axes.</code></pre>
</div>
</div>
<p>The alluvial diagram illustrates the intricate relationships between key cheese attributes: Milk Type, Cheese Family, Region, and Type. Cow milk emerges as the predominant contributor, flowing into a wide range of cheese families such as Cheddar, Blue, and Brie, and being associated with multiple regions and types. Goat and sheep milk are more specialized, supporting artisan cheese families like Feta and Swiss Cheese.</p>
<p>Regionally, areas like Quebec and British Columbia highlight Canada’s strong presence in cheese production, while European hubs like Auvergne and Leiden represent traditional cheese-making regions. The final column, “Type,” shows a significant emphasis on artisan cheeses across all categories, particularly soft and semi-soft types, reflecting traditional methods.</p>
<p>Overall, the diagram underscores the dominance of cow milk, the diversity of regional contributions, and the prevalence of artisan techniques in global cheese-making.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'networkD3'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:leaflet':

    JS</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>milk_to_type <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(milk, type) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">unique</span>(<span class="fu">c</span>(milk_to_type<span class="sc">$</span>milk, milk_to_type<span class="sc">$</span>type)))</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>milk_to_type<span class="sc">$</span>source <span class="ot">&lt;-</span> <span class="fu">match</span>(milk_to_type<span class="sc">$</span>milk, nodes<span class="sc">$</span>name) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>milk_to_type<span class="sc">$</span>target <span class="ot">&lt;-</span> <span class="fu">match</span>(milk_to_type<span class="sc">$</span>type, nodes<span class="sc">$</span>name) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> milk_to_type, <span class="at">Nodes =</span> nodes,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">Source =</span> <span class="st">"source"</span>, <span class="at">Target =</span> <span class="st">"target"</span>, <span class="at">Value =</span> <span class="st">"n"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">NodeID =</span> <span class="st">"name"</span>, <span class="at">fontSize =</span> <span class="dv">12</span>, <span class="at">nodeWidth =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Links is a tbl_df. Converting to a plain data frame.</code></pre>
</div>
<div class="cell-output-display">
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-c8e8921d3012a6002442" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c8e8921d3012a6002442">{"x":{"links":{"source":[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,4,4,4,4,4,4,4,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,9,9,9,9,9,9,9,9,9,10,10],"target":[11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,11,37,38,39,40,41,42,43,44,45,16,17,23,29,46,11,45,17,22,29,16,20,47,23,48,29,40,49,50,32,51,17,19,20,52,22,29,36,11,53,39,42,45,54,55,56,47,22,29,46,36,16,57,20,23,28,29,58,35,36,11,23,41],"value":[1,1,1,1,1,3,1,1,15,16,1,13,16,2,1,1,1,15,8,2,2,1,4,2,2,7,11,3,1,6,8,1,1,1,1,7,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,5,1,2,1,1,2,6,5,1,1,1,1,1,1,1,1,2,1,2,3,1,1,6,2,1,1,1,1,1,3,1,1]},"nodes":{"name":["camel","cow","cow, goat","cow, goat, sheep","cow, sheep","cow, water buffalo","goat","goat, sheep","moose","sheep","water buffalo","soft, artisan","firm, artisan","firm, artisan, blue-veined","firm, artisan, brined","fresh firm, soft-ripened","fresh soft","fresh soft, artisan","fresh soft, soft-ripened","hard","hard, artisan","hard, artisan, processed","semi-hard","semi-hard, artisan","semi-hard, artisan, smear-ripened","semi-hard, blue-veined","semi-hard, brined","semi-hard, soft-ripened","semi-soft","semi-soft, artisan","semi-soft, artisan, brined","semi-soft, blue-veined","semi-soft, brined","semi-soft, processed","semi-soft, smear-ripened","semi-soft, soft-ripened","soft","soft, artisan, blue-veined","soft, artisan, smear-ripened","soft, artisan, soft-ripened","soft, blue-veined","soft, brined","soft, processed","soft, semi-soft, artisan","soft, semi-soft, soft-ripened","soft, soft-ripened","semi-soft, whey","semi-firm, artisan","semi-hard, processed","fresh firm","hard, processed","fresh firm, artisan","hard, semi-hard","soft, artisan, brined","fresh soft, hard, artisan","fresh soft, whey","hard, whey","firm","semi-soft, artisan, soft-ripened"],"group":["camel","cow","cow, goat","cow, goat, sheep","cow, sheep","cow, water buffalo","goat","goat, sheep","moose","sheep","water buffalo","soft, artisan","firm, artisan","firm, artisan, blue-veined","firm, artisan, brined","fresh firm, soft-ripened","fresh soft","fresh soft, artisan","fresh soft, soft-ripened","hard","hard, artisan","hard, artisan, processed","semi-hard","semi-hard, artisan","semi-hard, artisan, smear-ripened","semi-hard, blue-veined","semi-hard, brined","semi-hard, soft-ripened","semi-soft","semi-soft, artisan","semi-soft, artisan, brined","semi-soft, blue-veined","semi-soft, brined","semi-soft, processed","semi-soft, smear-ripened","semi-soft, soft-ripened","soft","soft, artisan, blue-veined","soft, artisan, smear-ripened","soft, artisan, soft-ripened","soft, blue-veined","soft, brined","soft, processed","soft, semi-soft, artisan","soft, semi-soft, soft-ripened","soft, soft-ripened","semi-soft, whey","semi-firm, artisan","semi-hard, processed","fresh firm","hard, processed","fresh firm, artisan","hard, semi-hard","soft, artisan, brined","fresh soft, hard, artisan","fresh soft, whey","hard, whey","firm","semi-soft, artisan, soft-ripened"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Handle Missing Values and Select Numeric Columns</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>encoded_data <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.factor)) <span class="sc">%&gt;%</span> <span class="co"># Convert characters to factors</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.factor), as.numeric)) <span class="sc">%&gt;%</span>   <span class="co"># Convert factors to numeric</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))                          <span class="co"># Select only numeric columns</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if numeric columns have missing values and handle them</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>encoded_data <span class="ot">&lt;-</span> encoded_data <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(.)) <span class="sc">&lt;</span> <span class="fu">ncol</span>(.))  <span class="co"># Drop rows where all values are NA</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute the Correlation Matrix</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">ncol</span>(encoded_data) <span class="sc">&gt;</span> <span class="dv">1</span>) {  <span class="co"># Ensure there are multiple columns for correlation</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  correlation_matrix_full <span class="ot">&lt;-</span> <span class="fu">cor</span>(encoded_data, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3: Visualize the Correlation Matrix</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using ggcorrplot</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggcorrplot</span>(correlation_matrix_full, </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"circle"</span>, </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">"lower"</span>, </span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">lab =</span> <span class="cn">TRUE</span>, </span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">lab_size =</span> <span class="dv">3</span>, </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">"Correlation Matrix with Encoded Features"</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"white"</span>, <span class="st">"blue"</span>))</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using corrplot (alternative visualization)</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(correlation_matrix_full, </span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"lower"</span>, </span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">addCoef.col =</span> <span class="st">"black"</span>, </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">tl.col =</span> <span class="st">"black"</span>, </span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">tl.srt =</span> <span class="dv">45</span>, </span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">diag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Not enough numeric columns with complete data to compute correlations."</span>)</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    set_names</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the variables are factors</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>cheeses_clean <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">milk =</span> <span class="fu">as.factor</span>(milk),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.factor</span>(type))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode categorical variables into numeric values for the plot</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>cheeses_clean_encoded <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">milk =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(milk)),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(type)))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a parallel coordinate plot</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">data =</span> cheeses_clean_encoded, <span class="at">type =</span> <span class="st">'parcoords'</span>,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="sc">~</span>fat_content, <span class="at">colorscale =</span> <span class="st">"Viridis"</span>),</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">dimensions =</span> <span class="fu">list</span>(</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Fat Content"</span>, <span class="at">values =</span> <span class="sc">~</span>fat_content),</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Calcium Content"</span>, <span class="at">values =</span> <span class="sc">~</span>calcium_content),</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Milk"</span>, <span class="at">values =</span> <span class="sc">~</span>milk),</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="sc">~</span>type)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinates Plot for Multivariate Analysis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ed181874264649c862e0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ed181874264649c862e0">{"x":{"visdat":{"16c8279b5847":["function () ","plotlyVisDat"]},"cur_data":"16c8279b5847","attrs":{"16c8279b5847":{"line":{"color":{},"colorscale":"Viridis"},"dimensions":[{"label":"Fat Content","values":{}},{"label":"Calcium Content","values":{}},{"label":"Milk","values":{}},{"label":"Type","values":{}}],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"parcoords"}},"layout":{"margin":{"b":40,"l":60,"r":10},"title":"Parallel Coordinates Plot for Multivariate Analysis","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"line":{"color":[40,50,45,52,50,12,14,55,50,45,45,34,34,34,34,34,48,33.5,40,45,45,45,30,46,46,30,26,8,45,30,20,54.229999999999997,45,25,25,34,34,34,48,40,32,43,28.5,22,28,25.219999999999999,20,25.5,50,45,20,43.299999999999997,62,50,8,70,15,39.600000000000001,32.5,45,11,45,30,30,37,54,30,31,20,43.299999999999997,21,50,45,60,35,25,7,45,75,40,30,40,45,27,10,45,46,50,8,45,45,20,55,48,30,26,60,22,50,45,34.200000000000003,45,50,45,27,50,12,45,24,45,12,33,26,28,28,45,55,40,45,45,14,5,45,45,51,14,60,40,48,15,35,28,32,38,50,45,50,26,40,25,50,27,50,49,45,30,20,48,45,45,30,50,42,48,45,48,45,34,29.800000000000001,50,23,45,50,45,36,40,35,50,48,35,45,27,45,40,13,50,22,31,60,12,12,50,50,45,21,45,50,37,45,30,25.800000000000001,25.399999999999999,18.399999999999999,26,20.800000000000001,50,50,28,50,60,50,25,40,50,45,45,40,50,55,50,40,45,27,27,40,45,40,72.700000000000003,45,45,0,30.5,33,18.300000000000001,32.299999999999997,45,40.5,45,45,60,45,30,40,45,8,45,34.399999999999999,45,51,48,25,17,18.199999999999999,14,36,48,45,7.7999999999999998],"colorscale":"Viridis"},"dimensions":[{"label":"Fat Content","values":[40,50,45,52,50,12,14,55,50,45,45,34,34,34,34,34,48,33.5,40,45,45,45,30,46,46,30,26,8,45,30,20,54.229999999999997,45,25,25,34,34,34,48,40,32,43,28.5,22,28,25.219999999999999,20,25.5,50,45,20,43.299999999999997,62,50,8,70,15,39.600000000000001,32.5,45,11,45,30,30,37,54,30,31,20,43.299999999999997,21,50,45,60,35,25,7,45,75,40,30,40,45,27,10,45,46,50,8,45,45,20,55,48,30,26,60,22,50,45,34.200000000000003,45,50,45,27,50,12,45,24,45,12,33,26,28,28,45,55,40,45,45,14,5,45,45,51,14,60,40,48,15,35,28,32,38,50,45,50,26,40,25,50,27,50,49,45,30,20,48,45,45,30,50,42,48,45,48,45,34,29.800000000000001,50,23,45,50,45,36,40,35,50,48,35,45,27,45,40,13,50,22,31,60,12,12,50,50,45,21,45,50,37,45,30,25.800000000000001,25.399999999999999,18.399999999999999,26,20.800000000000001,50,50,28,50,60,50,25,40,50,45,45,40,50,55,50,40,45,27,27,40,45,40,72.700000000000003,45,45,0,30.5,33,18.300000000000001,32.299999999999997,45,40.5,45,45,60,45,30,40,45,8,45,34.399999999999999,45,51,48,25,17,18.199999999999999,14,36,48,45,7.7999999999999998]},{"label":"Calcium Content","values":[469,469,469,469,469,469,469,26,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,488,492,492,343,469,469,318,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,700,469,469,469,450,469,469,469,469,469,469,725,469,469,469,469,469,469,469,469,469,469,430,469,469,469,469,469,469,90,469,469,469,469,469,469,360,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,4768,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,497,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,469,208,469,469,469,469,469,469,469,469,469,469,469,469,469,190,469,469,469,469,469,469,469,469,469,469,469,30,921,990,1071,749,316,157,469,469,469,469,469,469,469,469,469,740,469,469,469,469,469,469,469,469,469,469,469]},{"label":"Milk","values":[3,3,11,11,3,3,3,3,3,3,8,3,3,3,3,3,3,3,9,9,3,11,null,3,3,3,7,9,8,9,9,3,11,3,4,3,3,3,3,4,3,3,3,5,3,3,3,3,11,3,9,3,3,3,3,3,3,8,3,5,8,3,6,3,3,6,3,3,3,3,8,8,3,3,3,3,3,3,3,3,3,9,3,4,8,8,6,3,3,3,8,11,6,3,3,8,3,2,3,6,5,9,3,3,3,3,8,8,4,8,3,3,3,3,3,3,3,8,3,3,3,8,3,3,3,4,3,3,3,null,null,3,3,3,11,8,3,11,3,8,8,4,9,3,11,null,null,11,9,8,3,3,3,11,3,3,3,3,3,11,3,3,3,8,9,6,3,6,3,3,11,3,3,3,11,3,8,3,3,10,3,3,3,7,12,3,3,3,11,3,1,3,3,8,7,3,3,3,9,3,3,3,11,3,8,3,3,3,3,3,3,3,3,3,6,3,3,3,8,3,3,3,null,3,3,12,3,3,3,3,8,3,8,3,4,3,3,3,3,11,3,3,8,8,8,3,3,3]},{"label":"Type","values":[20,29,14,14,31,27,20,38,35,13,9,14,14,14,14,14,21,27,20,19,29,1,33,20,20,34,16,10,39,18,37,14,14,32,28,40,13,13,27,9,14,34,39,9,27,8,38,27,27,27,20,44,14,27,27,49,20,20,20,28,28,38,14,44,44,44,14,34,39,38,38,39,8,46,13,20,7,36,39,28,49,12,28,37,43,38,8,27,23,40,46,28,19,13,49,17,49,39,21,28,20,28,14,39,43,48,38,41,8,39,42,21,49,43,28,39,26,14,39,21,27,28,43,34,14,39,44,39,20,39,38,49,38,38,38,39,38,30,28,38,38,49,38,13,39,38,38,14,38,6,21,20,35,39,14,13,20,3,21,21,28,22,21,9,37,14,21,25,14,43,14,49,39,28,36,21,9,2,44,8,43,21,21,32,45,28,40,44,21,13,null,9,21,49,5,47,21,36,38,11,27,13,14,39,38,13,44,21,45,20,8,13,31,43,21,22,27,27,39,27,4,13,13,13,13,21,21,27,21,44,6,20,13,14,21,39,13,39,14,39,28,20,9,9,14,14,24,15]}],"type":"parcoords","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare numeric data for PCA</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(numeric_data, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA clustering</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, <span class="at">data =</span> cheeses_clean, <span class="at">colour =</span> <span class="st">'type'</span>, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label.size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PCA Clustering of Cheeses"</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Principal Component 1"</span>,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Principal Component 2"</span>) <span class="sc">+</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example interaction plot</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(cheeses_clean<span class="sc">$</span>milk, cheeses_clean<span class="sc">$</span>type, cheeses_clean<span class="sc">$</span>fat_content,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">4</span>), <span class="at">legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">"Milk Type"</span>, <span class="at">ylab =</span> <span class="st">"Fat Content"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main =</span> <span class="st">"Interaction Between Milk and Cheese Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>world_coords <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">lat =</span> <span class="fu">mean</span>(lat), <span class="at">long =</span> <span class="fu">mean</span>(long))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>cheese_coords <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span> <span class="fu">count</span>(country) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(world_coords, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span> <span class="ot">=</span> <span class="st">"region"</span>))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(<span class="at">data =</span> cheese_coords) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> <span class="sc">~</span>long, <span class="at">lat =</span> <span class="sc">~</span>lat, <span class="at">radius =</span> <span class="sc">~</span>n <span class="sc">/</span> <span class="dv">10</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(country, <span class="st">"&lt;br&gt;Number of Cheeses:"</span>, n),</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">fillOpacity =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in validateCoords(lng, lat, funcName): Data contains 21 rows with
either missing or invalid lat/lon values and will be ignored</code></pre>
</div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-6878d281c0d1fbe4fb4f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6878d281c0d1fbe4fb4f">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[-37.65934036372371,-25.1829968212448,47.57973189914928,null,null,50.59062728413775,null,-9.802374640273754,65.29312210129171,null,null,44.64204021188665,35.06383926391602,49.88403902053833,55.70473306131043,null,null,null,null,null,46.16686105018805,null,51.20460854785544,null,null,null,38.35875267119733,47.23226486633871,65.30841881286756,23.39336982137758,53.49476024082728,31.8765000479562,42.16598249235487,null,55.08303815780148,19.77547650619459,52.09904686948087,-40.86267866811441,51.40997793704649,39.93083947704685,null,null,44.2524472068758,40.67995297908783,61.89590923058442,46.74156613273416,39.06608086718359,null,null,null,null],[-65.45939024557157,136.9985434157885,13.47336568551905,null,null,4.73210363007762,null,-55.28056799486391,-89.75617590060136,null,null,16.34878585682834,33.35030769348145,15.42377680937449,10.73125458083697,null,null,null,null,null,3.226979203100409,null,10.40115605525567,null,null,null,23.94053688131974,19.42393128225736,-19.8672900189364,83.51400315054786,-8.439389413500587,35.21034702119373,11.75285266441434,null,24.08004028566422,-11.62138300892721,5.322302248461026,147.1987909723098,19.08651571937755,-7.887035126327186,null,null,20.75116897611582,-2.906820906168191,17.57630542317692,8.312952255820209,34.29492853035705,null,null,null,null],[0.1,1.4,1.3,0.1,0.1,0.2,0.1,0.1,3.2,0.1,0.1,0.1,0.1,0.1,0.4,0.1,0.5,0.4,0.1,0.5,5.4,0.1,1,0.2,0.1,0.2,0.4,0.1,0.1,0.4,0.6,0.1,1.4,0.1,0.1,0.1,0.9,0.1,0.1,0.4,0.2,0.1,0.1,0.4,0.8,0.3,0.1,0.1,0.1,1.5,0.1],null,null,{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":0.5,"fill":true,"fillColor":"blue","fillOpacity":0.7},null,null,["Argentina <br>Number of Cheeses: 1","Australia <br>Number of Cheeses: 14","Austria <br>Number of Cheeses: 13","Austria, Germany <br>Number of Cheeses: 1","Bangladesh, India <br>Number of Cheeses: 1","Belgium <br>Number of Cheeses: 2","Belgium, Germany, Netherlands <br>Number of Cheeses: 1","Brazil <br>Number of Cheeses: 1","Canada <br>Number of Cheeses: 32","Canada, Denmark, France, Germany, Netherlands, United States <br>Number of Cheeses: 1","Canada, France <br>Number of Cheeses: 1","Croatia <br>Number of Cheeses: 1","Cyprus <br>Number of Cheeses: 1","Czech Republic <br>Number of Cheeses: 1","Denmark <br>Number of Cheeses: 4","Denmark, Finland, Germany, Iceland, Norway, Sweden <br>Number of Cheeses: 1","England <br>Number of Cheeses: 5","England, Great Britain, United Kingdom <br>Number of Cheeses: 4","England, Scotland, United Kingdom <br>Number of Cheeses: 1","England, United Kingdom <br>Number of Cheeses: 5","France <br>Number of Cheeses: 54","France, United States <br>Number of Cheeses: 1","Germany <br>Number of Cheeses: 10","Great Britain <br>Number of Cheeses: 2","Great Britain, Scotland, United Kingdom <br>Number of Cheeses: 1","Great Britain, United Kingdom, Wales <br>Number of Cheeses: 2","Greece <br>Number of Cheeses: 4","Hungary <br>Number of Cheeses: 1","Iceland <br>Number of Cheeses: 1","India <br>Number of Cheeses: 4","Ireland <br>Number of Cheeses: 6","Israel <br>Number of Cheeses: 1","Italy <br>Number of Cheeses: 14","Lebanon, Middle East <br>Number of Cheeses: 1","Lithuania <br>Number of Cheeses: 1","Mauritania <br>Number of Cheeses: 1","Netherlands <br>Number of Cheeses: 9","New Zealand <br>Number of Cheeses: 1","Poland <br>Number of Cheeses: 1","Portugal <br>Number of Cheeses: 4","Scotland <br>Number of Cheeses: 2","Scotland, United Kingdom <br>Number of Cheeses: 1","Serbia <br>Number of Cheeses: 1","Spain <br>Number of Cheeses: 4","Sweden <br>Number of Cheeses: 8","Switzerland <br>Number of Cheeses: 3","Turkey <br>Number of Cheeses: 1","United Kingdom <br>Number of Cheeses: 1","United Kingdom, Wales <br>Number of Cheeses: 1","United States <br>Number of Cheeses: 15","NA <br>Number of Cheeses: 1"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-40.86267866811441,65.30841881286756],"lng":[-89.75617590060136,147.1987909723098]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemapify)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>cheese_tree <span class="ot">&lt;-</span> cheeses_clean <span class="sc">%&gt;%</span> <span class="fu">count</span>(family, type, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cheese_tree, <span class="fu">aes</span>(<span class="at">area =</span> n, <span class="at">fill =</span> family, <span class="at">label =</span> type)) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_treemap</span>() <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_treemap_text</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">place =</span> <span class="st">"center"</span>, <span class="at">grow =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cheese Families and Their Types"</span>, <span class="at">fill =</span> <span class="st">"Family"</span>) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The treemap titled “Cheese Families and Their Types” provides a detailed representation of the diversity within cheese families and their specific types. The size of each tile corresponds to the frequency or prominence of a particular cheese type, while the colors represent different cheese families. This visualization highlights the balance between commonly produced cheese categories and more specialized or niche varieties, offering a comprehensive view of global cheese-making diversity.</p>
<p>The most dominant category in the treemap is hard cheeses, represented by the largest tiles labeled “hard” and “hard, artisan.” This indicates that hard cheeses are the most frequently produced and widely consumed. Hard cheeses, known for their durability, aging potential, and complex flavor profiles, are staples in many cuisines and are often associated with high culinary versatility. Subcategories like “hard, processed” further reflect the industrial scale at which these cheeses are manufactured, while “hard, artisan” emphasizes the ongoing popularity of traditional and handcrafted production methods.</p>
<p>Following hard cheeses, semi-hard cheeses occupy a significant portion of the treemap, with tiles such as “semi-hard, artisan” and “semi-hard, processed.” These cheeses bridge the gap between the firmness of hard cheeses and the creaminess of soft varieties, making them highly versatile and appealing to a broad consumer base. The prominence of artisan labels within the semi-hard category suggests that traditional methods remain a preferred approach for these types, catering to consumers seeking unique and high-quality products.</p>
<p>Soft cheeses also have a notable presence in the chart, particularly subcategories like “soft, soft-ripened” and “soft, blue-veined.” These cheeses are characterized by their creamy textures and rich flavors, often associated with gourmet applications and casual consumption alike. The inclusion of “soft, artisan” highlights the importance of handcrafted production in maintaining the distinct qualities of soft cheeses, while variations such as “soft, brined” and “soft, whey” reflect the diversity of techniques employed in soft cheese-making.</p>
<p>The treemap also captures the significant diversity within cheese families, represented by a wide range of colors. Families such as Blue, Brie, Cheddar, Gouda, Parmesan, and others appear frequently, indicating their global popularity and adaptability to different production styles. For example, Blue cheeses are known for their tangy and sharp flavors, while Brie and Gouda cater to both traditional and modern tastes. The presence of specific labels like “semi-soft, blue-veined” or “soft, artisan, soft-ripened” within these families illustrates the adaptability of these cheeses to various culinary and regional preferences.</p>
<p>Smaller tiles in the treemap, such as “fresh firm,” “semi-soft, whey,” and “firm, artisan, brined,” represent niche cheese types that, while less commonly produced, cater to specific markets and traditions. These smaller categories reflect the depth of cheese diversity, showcasing lesser-known styles that are often regionally specific or tied to unique production techniques.</p>
<p>An interesting trend highlighted by the treemap is the frequent occurrence of the term “artisan.” Across multiple categories and families, the artisan label underscores the growing consumer preference for handcrafted, high-quality cheeses. This aligns with broader food industry trends, where there is increasing demand for artisanal and locally produced goods. At the same time, the inclusion of processed types within categories like hard and semi-hard cheeses indicates the balance between mass production for affordability and traditional methods for quality.</p>
<p>Conclusion</p>
<p>This treemap effectively illustrates the intricate diversity of cheese production, highlighting both dominant and niche categories. The prominence of hard cheeses underscores their global popularity and culinary versatility, while the significant presence of semi-hard and soft varieties reflects their widespread appeal. The inclusion of artisan labels emphasizes the importance of traditional cheese-making methods in maintaining quality and uniqueness, even as industrial production caters to larger markets. By capturing the range of cheese families and types, this visualization offers a detailed glimpse into the richness of global cheese-making traditions and the interplay between heritage and modernity in the industry.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link" aria-label="Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./d3graph.html" class="pagination-link" aria-label="Interactive graph">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/SaatvikInampudi/cheeses/edit/main/results.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/SaatvikInampudi/cheeses/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>